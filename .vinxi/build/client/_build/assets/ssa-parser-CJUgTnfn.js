function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/errors-nIGggbx0.js","assets/prod-xF6WKuRG.js","assets/syncStore-BssUQgBy.js","assets/routing-BmD2xUmi.js","assets/Link-Dg-h0Eyu.js","assets/components-BMGKah2q.js","assets/index-BnPmuIsI.js","assets/index-DPECAXpK.js","assets/index-Cb4tY8hP.js","assets/syncStore-CgD1nZSu.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{_ as M}from"./syncStore-BssUQgBy.js";import{b as F,p as E}from"./prod-xF6WKuRG.js";import"./routing-BmD2xUmi.js";import"./Link-Dg-h0Eyu.js";import"./components-BMGKah2q.js";import"./index-BnPmuIsI.js";import"./index-DPECAXpK.js";import"./index-Cb4tY8hP.js";const d=/^Format:[\s\t]*/,R=/^Style:[\s\t]*/,y=/^Dialogue:[\s\t]*/,b=/[\s\t]*,[\s\t]*/,I=/\{[^}]+\}/g,w=/\\N/g,P=/^\[(.*)[\s\t]?Styles\]$/,S=/^\[(.*)[\s\t]?Events\]$/;class A{f;P=0;a=null;j=[];k=[];O=null;d;Q={};async init(t){this.f=t,t.errors&&(this.d=(await M(()=>import("./errors-nIGggbx0.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]))).ParseErrorBuilder)}parse(t,l){if(this.P)switch(this.P){case 1:if(t==="")this.P=0;else if(R.test(t))if(this.O){const e=t.replace(R,"").split(b);this.T(e)}else this.e(this.d?.N("Style",l));else d.test(t)?this.O=t.replace(d,"").split(b):S.test(t)&&(this.O=null,this.P=2);break;case 2:if(t==="")this.R();else if(y.test(t))if(this.R(),this.O){const e=t.replace(y,"").split(b),s=this.U(e,l);s&&(this.a=s)}else this.e(this.d?.N("Dialogue",l));else this.a?this.a.text+=`
`+t.replace(I,"").replace(w,`
`):d.test(t)?this.O=t.replace(d,"").split(b):P.test(t)?(this.O=null,this.P=1):S.test(t)&&(this.O=null)}else t===""||(P.test(t)?(this.O=null,this.P=1):S.test(t)&&(this.O=null,this.P=2))}done(){return{metadata:{},cues:this.j,regions:[],errors:this.k}}R(){this.a&&(this.j.push(this.a),this.f.onCue?.(this.a),this.a=null)}T(t){let l="Default",e={},s,a="center",r="bottom",g,n=1.2,o,h,c=3,f=[];for(let u=0;u<this.O.length;u++){const x=this.O[u],i=t[u];switch(x){case"Name":l=i;break;case"Fontname":e["font-family"]=i;break;case"Fontsize":e["font-size"]=`calc(${i} / var(--overlay-height))`;break;case"PrimaryColour":const T=k(i);T&&(e["--cue-color"]=T);break;case"BorderStyle":c=parseInt(i,10);break;case"BackColour":h=k(i);break;case"OutlineColour":const _=k(i);_&&(o=_);break;case"Bold":parseInt(i)&&(e["font-weight"]="bold");break;case"Italic":parseInt(i)&&(e["font-style"]="italic");break;case"Underline":parseInt(i)&&(e["text-decoration"]="underline");break;case"StrikeOut":parseInt(i)&&(e["text-decoration"]="line-through");break;case"Spacing":e["letter-spacing"]=i+"px";break;case"AlphaLevel":e.opacity=parseFloat(i);break;case"ScaleX":f.push(`scaleX(${parseFloat(i)/100})`);break;case"ScaleY":f.push(`scaleY(${parseFloat(i)/100})`);break;case"Angle":f.push(`rotate(${i}deg)`);break;case"Shadow":n=parseInt(i,10)*1.2;break;case"MarginL":e["--cue-width"]="auto",e["--cue-left"]=parseFloat(i)+"px";break;case"MarginR":e["--cue-width"]="auto",e["--cue-right"]=parseFloat(i)+"px";break;case"MarginV":g=parseFloat(i);break;case"Outline":s=parseInt(i,10);break;case"Alignment":const m=parseInt(i,10);switch(m>=4&&(r=m>=7?"top":"center"),m%3){case 1:a="start";break;case 2:a="center";break;case 3:a="end";break}}}if(e.S=r,e["--cue-white-space"]="normal",e["--cue-line-height"]="normal",e["--cue-text-align"]=a,r==="center"?(e["--cue-top"]="50%",f.push("translateY(-50%)")):e[`--cue-${r}`]=(g||0)+"px",c===1&&(e["--cue-padding-y"]="0"),(c===1||h)&&(e["--cue-bg-color"]=c===1?"none":h),c===3&&o&&(e["--cue-outline"]=`${s}px solid ${o}`),c===1&&typeof s=="number"){const u=h??"#000";e["--cue-text-shadow"]=[o&&O(s*1.2,n*1.2,o),o?O(s*(s/2),n*(s/2),u):O(s,n,u)].filter(Boolean).join(", ")}f.length&&(e["--cue-transform"]=f.join(" ")),this.Q[l]=e}U(t,l){const e=this.V(t),s=this.o(e.Start,e.End,l);if(!s)return;const a=new F(s[0],s[1],""),r={...this.Q[e.Style]||{}},g=e.Name?`<v ${e.Name}>`:"",n=r.S,o=e.MarginL&&parseFloat(e.MarginL),h=e.MarginR&&parseFloat(e.MarginR),c=e.MarginV&&parseFloat(e.MarginV);return o&&(r["--cue-width"]="auto",r["--cue-left"]=o+"px"),h&&(r["--cue-width"]="auto",r["--cue-right"]=h+"px"),c&&n!=="center"&&(r[`--cue-${n}`]=c+"px"),a.text=g+t.slice(this.O.length-1).join(", ").replace(I,"").replace(w,`
`),delete r.S,Object.keys(r).length&&(a.style=r),a}V(t){const l={};for(let e=0;e<this.O.length;e++)l[this.O[e]]=t[e];return l}o(t,l,e){const s=E(t),a=E(l);if(s!==null&&a!==null&&a>s)return[s,a];s===null&&this.e(this.d?.q(t,e)),a===null&&this.e(this.d?.r(l,e)),s!=null&&a!==null&&a>s&&this.e(this.d?.s(s,a,e))}e(t){if(t){if(this.k.push(t),this.f.strict)throw this.f.cancel(),t;this.f.onError?.(t)}}}function k(p){const t=parseInt(p.replace("&H",""),16);if(t>=0){const e=(t>>24&255^255)/255,s=t>>16&255,a=t>>8&255;return"rgba("+[t&255,a,s,e].join(",")+")"}return null}function O(p,t,l){const e=Math.ceil(2*Math.PI*p);let s="";for(let a=0;a<e;a++){const r=2*Math.PI*a/e;s+=p*Math.cos(r)+"px "+t*Math.sin(r)+"px 0 "+l+(a==e-1?"":",")}return s}function B(){return new A}export{A as SSAParser,B as default};
//# sourceMappingURL=ssa-parser-CJUgTnfn.js.map
