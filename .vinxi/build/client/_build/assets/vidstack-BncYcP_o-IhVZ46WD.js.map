{"version":3,"file":"vidstack-BncYcP_o-IhVZ46WD.js","sources":["../../../../../node_modules/.pnpm/vidstack@1.11.13/node_modules/vidstack/prod/chunks/vidstack-BncYcP_o.js"],"sourcesContent":["import { n as deferredPromise, f as signal, l as listenEvent, g as effect, p as peek, i as isString } from './vidstack-CSyVEdLV.js';\nimport { a as appendParamsToURL } from './vidstack-BhcIzQoA.js';\n\nfunction timedPromise(callback, ms = 3e3) {\n  const promise = deferredPromise();\n  setTimeout(() => {\n    const rejection = callback();\n    if (rejection)\n      promise.reject(rejection);\n  }, ms);\n  return promise;\n}\n\nclass EmbedProvider {\n  constructor(_iframe) {\n    this.db = _iframe;\n    this.cb = signal(\"\");\n    /**\n     * Defines which referrer is sent when fetching the resource.\n     *\n     * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/HTMLIFrameElement/referrerPolicy}\n     */\n    this.referrerPolicy = null;\n    _iframe.setAttribute(\"frameBorder\", \"0\");\n    _iframe.setAttribute(\"aria-hidden\", \"true\");\n    _iframe.setAttribute(\n      \"allow\",\n      \"autoplay; fullscreen; encrypted-media; picture-in-picture; accelerometer; gyroscope\"\n    );\n    if (this.referrerPolicy !== null) {\n      _iframe.setAttribute(\"referrerpolicy\", this.referrerPolicy);\n    }\n  }\n  get iframe() {\n    return this.db;\n  }\n  setup() {\n    listenEvent(window, \"message\", this.Lg.bind(this));\n    listenEvent(this.db, \"load\", this.lc.bind(this));\n    effect(this.fd.bind(this));\n  }\n  fd() {\n    const src = this.cb();\n    if (!src.length) {\n      this.db.setAttribute(\"src\", \"\");\n      return;\n    }\n    const params = peek(() => this.Te());\n    this.db.setAttribute(\"src\", appendParamsToURL(src, params));\n  }\n  gd(message, target) {\n    this.db.contentWindow?.postMessage(JSON.stringify(message), target ?? \"*\");\n  }\n  Lg(event) {\n    const origin = this.eb(), isOriginMatch = (event.source === null || event.source === this.db?.contentWindow) && (!isString(origin) || origin === event.origin);\n    if (!isOriginMatch)\n      return;\n    try {\n      const message = JSON.parse(event.data);\n      if (message)\n        this.hd(message, event);\n      return;\n    } catch (e) {\n    }\n    if (event.data)\n      this.hd(event.data, event);\n  }\n}\n\nexport { EmbedProvider as E, timedPromise as t };\n"],"names":["timedPromise","callback","ms","promise","deferredPromise","setTimeout","rejection","reject","EmbedProvider","constructor","_iframe","db","cb","signal","referrerPolicy","setAttribute","iframe","setup","listenEvent","window","Lg","bind","lc","effect","fd","src","length","params","peek","Te","appendParamsToURL","gd","message","target","contentWindow","postMessage","JSON","stringify","event","origin","eb","source","isString","parse","data","hd"],"mappings":"6FAGA,SAASA,EAAaC,EAAUC,EAAK,IAAK,CACxC,MAAMC,EAAUC,IAChBC,kBAAW,IAAM,CACf,MAAMC,EAAYL,IACdK,GACFH,EAAQI,OAAOD,CAAS,CAC3B,EAAEJ,CAAE,EACEC,CACT,CAEA,MAAMK,CAAc,CAClBC,YAAYC,EAAS,CACnB,KAAKC,GAAKD,EACV,KAAKE,GAAKC,EAAO,EAAE,EAMnB,KAAKC,eAAiB,KACtBJ,EAAQK,aAAa,cAAe,GAAG,EACvCL,EAAQK,aAAa,cAAe,MAAM,EAC1CL,EAAQK,aACN,QACA,qFACF,EACI,KAAKD,iBAAmB,MAC1BJ,EAAQK,aAAa,iBAAkB,KAAKD,cAAc,CAE9D,CACA,IAAIE,QAAS,CACX,OAAO,KAAKL,EACd,CACAM,OAAQ,CACNC,EAAYC,OAAQ,UAAW,KAAKC,GAAGC,KAAK,IAAI,CAAC,EACjDH,EAAY,KAAKP,GAAI,OAAQ,KAAKW,GAAGD,KAAK,IAAI,CAAC,EAC/CE,EAAO,KAAKC,GAAGH,KAAK,IAAI,CAAC,CAC3B,CACAG,IAAK,CACH,MAAMC,EAAM,KAAKb,KACjB,GAAI,CAACa,EAAIC,OAAQ,CACf,KAAKf,GAAGI,aAAa,MAAO,EAAE,EAC9B,MACF,CACA,MAAMY,EAASC,EAAK,IAAM,KAAKC,GAAI,CAAA,EACnC,KAAKlB,GAAGI,aAAa,MAAOe,EAAkBL,EAAKE,CAAM,CAAC,CAC5D,CACAI,GAAGC,EAASC,EAAQ,CAClB,KAAKtB,GAAGuB,eAAeC,YAAYC,KAAKC,UAAUL,CAAO,EAAGC,GAAU,GAAG,CAC3E,CACAb,GAAGkB,EAAO,CACR,MAAMC,EAAS,KAAKC,GAAI,EACxB,IAD2CF,EAAMG,SAAW,MAAQH,EAAMG,SAAW,KAAK9B,IAAIuB,iBAAmB,CAACQ,EAASH,CAAM,GAAKA,IAAWD,EAAMC,QAGvJ,IAAI,CACF,MAAMP,EAAUI,KAAKO,MAAML,EAAMM,IAAI,EACjCZ,GACF,KAAKa,GAAGb,EAASM,CAAK,EACxB,MACF,MAAY,CACZ,CACIA,EAAMM,MACR,KAAKC,GAAGP,EAAMM,KAAMN,CAAK,EAC7B,CACF","x_google_ignoreList":[0]}