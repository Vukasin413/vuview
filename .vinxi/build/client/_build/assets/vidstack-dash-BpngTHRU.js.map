{"version":3,"file":"vidstack-dash-BpngTHRU.js","sources":["../../../../../node_modules/.pnpm/vidstack@1.11.13/node_modules/vidstack/prod/providers/vidstack-dash.js"],"sourcesContent":["import { l as loadScript, p as preconnect } from '../chunks/vidstack-BhcIzQoA.js';\nimport { c as canPlayVideoType, t as canPlayAudioType, I as IS_CHROME, u as isDASHSupported } from '../chunks/vidstack-BupzoABp.js';\nimport { VideoProvider } from './vidstack-video.js';\nimport { l as listenEvent, g as effect, D as DOMEvent, j as isNumber, i as isString, S as camelToKebabCase, h as isUndefined, x as isFunction, p as peek } from '../chunks/vidstack-CSyVEdLV.js';\nimport { Q as QualitySymbol } from '../chunks/vidstack-B3EgHpRH.js';\nimport { a as TextTrackSymbol, T as TextTrack } from '../chunks/vidstack-CqXkSIjG.js';\nimport { L as ListSymbol } from '../chunks/vidstack-CerDQCFL.js';\nimport { R as RAFLoop } from '../chunks/vidstack-CpkvFYuN.js';\nimport { c as coerceToError } from '../chunks/vidstack-DM_McBs5.js';\nimport './vidstack-html.js';\nimport '../chunks/vidstack-ksPACRiU.js';\nimport '../chunks/vidstack-BJhWhebu.js';\n\nconst toDOMEventType = (type) => `dash-${camelToKebabCase(type)}`;\nclass DASHController {\n  constructor(_video, _ctx) {\n    this.m = _video;\n    this.b = _ctx;\n    this.g = null;\n    this.nd = null;\n    this.od = {};\n    this.pd = /* @__PURE__ */ new Set();\n    this.Xo = null;\n    this._o = {};\n    this.yk = -1;\n  }\n  get instance() {\n    return this.g;\n  }\n  setup(ctor) {\n    this.g = ctor().create();\n    const dispatcher = this.So.bind(this);\n    for (const event of Object.values(ctor.events))\n      this.g.on(event, dispatcher);\n    this.g.on(ctor.events.ERROR, this.U.bind(this));\n    for (const callback of this.pd)\n      callback(this.g);\n    this.b.player.dispatch(\"dash-instance\", {\n      detail: this.g\n    });\n    this.g.initialize(this.m, void 0, false);\n    this.g.updateSettings({\n      streaming: {\n        text: {\n          // Disabling text rendering by dash.\n          defaultEnabled: false,\n          dispatchForManualRendering: true\n        },\n        buffer: {\n          /// Enables buffer replacement when switching bitrates for faster switching.\n          fastSwitchEnabled: true\n        }\n      },\n      ...this.od\n    });\n    this.g.on(ctor.events.FRAGMENT_LOADING_STARTED, this.bp.bind(this));\n    this.g.on(\n      ctor.events.FRAGMENT_LOADING_COMPLETED,\n      this.cp.bind(this)\n    );\n    this.g.on(ctor.events.MANIFEST_LOADED, this.Uo.bind(this));\n    this.g.on(ctor.events.QUALITY_CHANGE_RENDERED, this.fb.bind(this));\n    this.g.on(ctor.events.TEXT_TRACKS_ADDED, this.dp.bind(this));\n    this.g.on(ctor.events.TRACK_CHANGE_RENDERED, this._d.bind(this));\n    this.b.qualities[QualitySymbol.Za] = this.Yg.bind(this);\n    listenEvent(this.b.qualities, \"change\", this.Yo.bind(this));\n    listenEvent(this.b.audioTracks, \"change\", this.Zo.bind(this));\n    this.nd = effect(this._g.bind(this));\n  }\n  Wo(event) {\n    return new DOMEvent(toDOMEventType(event.type), { detail: event });\n  }\n  _g() {\n    if (!this.b.$state.live())\n      return;\n    const raf = new RAFLoop(this.$g.bind(this));\n    raf.Bb();\n    return raf.ra.bind(raf);\n  }\n  $g() {\n    if (!this.g)\n      return;\n    const position = this.g.duration() - this.g.time();\n    this.b.$state.liveSyncPosition.set(!isNaN(position) ? position : Infinity);\n  }\n  So(event) {\n    this.b.player?.dispatch(this.Wo(event));\n  }\n  ep(event) {\n    const native = this.Xo?.[TextTrackSymbol.T], cues = (native?.track).cues;\n    if (!native || !cues)\n      return;\n    const id = this.Xo.id, startIndex = this._o[id] ?? 0, trigger = this.Wo(event);\n    for (let i = startIndex; i < cues.length; i++) {\n      const cue = cues[i];\n      if (!cue.positionAlign)\n        cue.positionAlign = \"auto\";\n      this.Xo.addCue(cue, trigger);\n    }\n    this._o[id] = cues.length;\n  }\n  dp(event) {\n    if (!this.g)\n      return;\n    const data = event.tracks, nativeTextTracks = [...this.m.textTracks].filter((track) => \"manualMode\" in track), trigger = this.Wo(event);\n    for (let i = 0; i < nativeTextTracks.length; i++) {\n      const textTrackInfo = data[i], nativeTextTrack = nativeTextTracks[i];\n      const id = `dash-${textTrackInfo.kind}-${i}`, track = new TextTrack({\n        id,\n        label: textTrackInfo?.label ?? textTrackInfo.labels.find((t) => t.text)?.text ?? textTrackInfo?.lang ?? void 0,\n        language: textTrackInfo.lang ?? void 0,\n        kind: textTrackInfo.kind,\n        default: textTrackInfo.defaultTrack\n      });\n      track[TextTrackSymbol.T] = {\n        managed: true,\n        track: nativeTextTrack\n      };\n      track[TextTrackSymbol.M] = 2;\n      track[TextTrackSymbol.Ua] = () => {\n        if (!this.g)\n          return;\n        if (track.mode === \"showing\") {\n          this.g.setTextTrack(i);\n          this.Xo = track;\n        } else {\n          this.g.setTextTrack(-1);\n          this.Xo = null;\n        }\n      };\n      this.b.textTracks.add(track, trigger);\n    }\n  }\n  _d(event) {\n    const { mediaType, newMediaInfo } = event;\n    if (mediaType === \"audio\") {\n      const track = this.b.audioTracks.getById(`dash-audio-${newMediaInfo.index}`);\n      if (track) {\n        const trigger = this.Wo(event);\n        this.b.audioTracks[ListSymbol.pa](track, true, trigger);\n      }\n    }\n  }\n  fb(event) {\n    if (event.mediaType !== \"video\")\n      return;\n    const quality = this.b.qualities[event.newQuality];\n    if (quality) {\n      const trigger = this.Wo(event);\n      this.b.qualities[ListSymbol.pa](quality, true, trigger);\n    }\n  }\n  Uo(event) {\n    if (this.b.$state.canPlay() || !this.g)\n      return;\n    const { type, mediaPresentationDuration } = event.data, trigger = this.Wo(event);\n    this.b.delegate.c(\n      \"stream-type-change\",\n      type !== \"static\" ? \"live\" : \"on-demand\",\n      trigger\n    );\n    this.b.delegate.c(\"duration-change\", mediaPresentationDuration, trigger);\n    this.b.qualities[QualitySymbol.Ya](true, trigger);\n    const media = this.g.getVideoElement();\n    const videoQualities = this.g.getTracksForTypeFromManifest(\n      \"video\",\n      event.data\n    );\n    const supportedVideoMimeType = [...new Set(videoQualities.map((e) => e.mimeType))].find(\n      (type2) => type2 && canPlayVideoType(media, type2)\n    );\n    const videoQuality = videoQualities.filter(\n      (track) => supportedVideoMimeType === track.mimeType\n    )[0];\n    let audioTracks = this.g.getTracksForTypeFromManifest(\n      \"audio\",\n      event.data\n    );\n    const supportedAudioMimeType = [...new Set(audioTracks.map((e) => e.mimeType))].find(\n      (type2) => type2 && canPlayAudioType(media, type2)\n    );\n    audioTracks = audioTracks.filter((track) => supportedAudioMimeType === track.mimeType);\n    videoQuality.bitrateList.forEach((bitrate, index) => {\n      const quality = {\n        id: bitrate.id?.toString() ?? `dash-bitrate-${index}`,\n        width: bitrate.width ?? 0,\n        height: bitrate.height ?? 0,\n        bitrate: bitrate.bandwidth ?? 0,\n        codec: videoQuality.codec,\n        index\n      };\n      this.b.qualities[ListSymbol.oa](quality, trigger);\n    });\n    if (isNumber(videoQuality.index)) {\n      const quality = this.b.qualities[videoQuality.index];\n      if (quality)\n        this.b.qualities[ListSymbol.pa](quality, true, trigger);\n    }\n    audioTracks.forEach((audioTrack, index) => {\n      const localTrack = {\n        id: `dash-audio-${audioTrack?.index}`,\n        label: audioTrack.label ?? audioTrack.lang ?? \"\",\n        language: audioTrack.lang ?? \"\",\n        kind: \"main\",\n        mimeType: audioTrack.mimeType,\n        codec: audioTrack.codec,\n        index\n      };\n      this.b.audioTracks[ListSymbol.oa](localTrack, trigger);\n    });\n    media.dispatchEvent(new DOMEvent(\"canplay\", { trigger }));\n  }\n  U(event) {\n    const { type: eventType, error: data } = event;\n    switch (data.code) {\n      case 27:\n        this.Ck(data);\n        break;\n      default:\n        this.Ak(data);\n        break;\n    }\n  }\n  bp() {\n    if (this.yk >= 0)\n      this.zk();\n  }\n  cp(event) {\n    const mediaType = event.mediaType;\n    if (mediaType === \"text\") {\n      requestAnimationFrame(this.ep.bind(this, event));\n    }\n  }\n  Ck(error) {\n    this.zk();\n    this.g?.play();\n    this.yk = window.setTimeout(() => {\n      this.yk = -1;\n      this.Ak(error);\n    }, 5e3);\n  }\n  zk() {\n    clearTimeout(this.yk);\n    this.yk = -1;\n  }\n  Ak(error) {\n    this.b.delegate.c(\"error\", {\n      message: error.message ?? \"\",\n      code: 1,\n      error\n    });\n  }\n  Yg() {\n    this.Ro(\"video\", true);\n    const { qualities } = this.b;\n    this.g?.setQualityFor(\"video\", qualities.selectedIndex, true);\n  }\n  Ro(type, auto) {\n    this.g?.updateSettings({\n      streaming: { abr: { autoSwitchBitrate: { [type]: auto } } }\n    });\n  }\n  Yo() {\n    const { qualities } = this.b;\n    if (!this.g || qualities.auto || !qualities.selected)\n      return;\n    this.Ro(\"video\", false);\n    this.g.setQualityFor(\"video\", qualities.selectedIndex, qualities.switch === \"current\");\n    if (IS_CHROME) {\n      this.m.currentTime = this.m.currentTime;\n    }\n  }\n  Zo() {\n    if (!this.g)\n      return;\n    const { audioTracks } = this.b, selectedTrack = this.g.getTracksFor(\"audio\").find(\n      (track) => audioTracks.selected && audioTracks.selected.id === `dash-audio-${track.index}`\n    );\n    if (selectedTrack)\n      this.g.setCurrentTrack(selectedTrack);\n  }\n  H() {\n    this.zk();\n    this.Xo = null;\n    this._o = {};\n  }\n  loadSource(src) {\n    this.H();\n    if (!isString(src.src))\n      return;\n    this.g?.attachSource(src.src);\n  }\n  destroy() {\n    this.H();\n    this.g?.destroy();\n    this.g = null;\n    this.nd?.();\n    this.nd = null;\n  }\n}\n\nclass DASHLibLoader {\n  constructor(_lib, _ctx, _callback) {\n    this.W = _lib;\n    this.b = _ctx;\n    this.Ca = _callback;\n    this.bh();\n  }\n  async bh() {\n    const callbacks = {\n      onLoadStart: this.Ea.bind(this),\n      onLoaded: this.qd.bind(this),\n      onLoadError: this.ch.bind(this)\n    };\n    let ctor = await loadDASHScript(this.W, callbacks);\n    if (isUndefined(ctor) && !isString(this.W))\n      ctor = await importDASH(this.W, callbacks);\n    if (!ctor)\n      return null;\n    if (!window.dashjs.supportsMediaSource()) {\n      const message = \"[vidstack] `dash.js` is not supported in this environment\";\n      this.b.player.dispatch(new DOMEvent(\"dash-unsupported\"));\n      this.b.delegate.c(\"error\", { message, code: 4 });\n      return null;\n    }\n    return ctor;\n  }\n  Ea() {\n    this.b.player.dispatch(new DOMEvent(\"dash-lib-load-start\"));\n  }\n  qd(ctor) {\n    this.b.player.dispatch(\n      new DOMEvent(\"dash-lib-loaded\", {\n        detail: ctor\n      })\n    );\n    this.Ca(ctor);\n  }\n  ch(e) {\n    const error = coerceToError(e);\n    this.b.player.dispatch(\n      new DOMEvent(\"dash-lib-load-error\", {\n        detail: error\n      })\n    );\n    this.b.delegate.c(\"error\", {\n      message: error.message,\n      code: 4,\n      error\n    });\n  }\n}\nasync function importDASH(loader, callbacks = {}) {\n  if (isUndefined(loader))\n    return void 0;\n  callbacks.onLoadStart?.();\n  if (loader.prototype && loader.prototype !== Function) {\n    callbacks.onLoaded?.(loader);\n    return loader;\n  }\n  try {\n    const ctor = (await loader())?.default;\n    if (ctor) {\n      callbacks.onLoaded?.(ctor);\n    } else {\n      throw Error(\n        false ? \"[vidstack] failed importing `dash.js`. Dynamic import returned invalid constructor.\" : \"\"\n      );\n    }\n    return ctor;\n  } catch (err) {\n    callbacks.onLoadError?.(err);\n  }\n  return void 0;\n}\nasync function loadDASHScript(src, callbacks = {}) {\n  if (!isString(src))\n    return void 0;\n  callbacks.onLoadStart?.();\n  try {\n    await loadScript(src);\n    if (!isFunction(window.dashjs.MediaPlayer)) {\n      throw Error(\n        false ? \"[vidstack] failed loading `dash.js`. Could not find a valid `Dash` constructor on window\" : \"\"\n      );\n    }\n    const ctor = window.dashjs.MediaPlayer;\n    callbacks.onLoaded?.(ctor);\n    return ctor;\n  } catch (err) {\n    callbacks.onLoadError?.(err);\n  }\n  return void 0;\n}\n\nconst JS_DELIVR_CDN = \"https://cdn.jsdelivr.net\";\nclass DASHProvider extends VideoProvider {\n  constructor() {\n    super(...arguments);\n    this.$$PROVIDER_TYPE = \"DASH\";\n    this.Xe = null;\n    this.d = new DASHController(this.video, this.b);\n    this.Gb = `${JS_DELIVR_CDN}/npm/dashjs@4.7.4/dist/dash${\".all.min.js\"}`;\n  }\n  /**\n   * The `dash.js` constructor.\n   */\n  get ctor() {\n    return this.Xe;\n  }\n  /**\n   * The current `dash.js` instance.\n   */\n  get instance() {\n    return this.d.instance;\n  }\n  static {\n    /**\n     * Whether `dash.js` is supported in this environment.\n     */\n    this.supported = isDASHSupported();\n  }\n  get type() {\n    return \"dash\";\n  }\n  get canLiveSync() {\n    return true;\n  }\n  /**\n   * The `dash.js` configuration object.\n   *\n   * @see {@link https://cdn.dashjs.org/latest/jsdoc/module-Settings.html}\n   */\n  get config() {\n    return this.d.od;\n  }\n  set config(config) {\n    this.d.od = config;\n  }\n  /**\n   * The `dash.js` constructor (supports dynamic imports) or a URL of where it can be found.\n   *\n   * @defaultValue `https://cdn.jsdelivr.net/npm/dashjs@4.7.4/dist/dash.all.min.js`\n   */\n  get library() {\n    return this.Gb;\n  }\n  set library(library) {\n    this.Gb = library;\n  }\n  preconnect() {\n    if (!isString(this.Gb))\n      return;\n    preconnect(this.Gb);\n  }\n  setup() {\n    super.setup();\n    new DASHLibLoader(this.Gb, this.b, (ctor) => {\n      this.Xe = ctor;\n      this.d.setup(ctor);\n      this.b.delegate.c(\"provider-setup\", this);\n      const src = peek(this.b.$state.source);\n      if (src)\n        this.loadSource(src);\n    });\n  }\n  async loadSource(src, preload) {\n    if (!isString(src.src)) {\n      this.Bn();\n      return;\n    }\n    this.a.preload = preload || \"\";\n    this.yn(src, \"application/x-mpegurl\");\n    this.d.loadSource(src);\n    this.V = src;\n  }\n  /**\n   * The given callback is invoked when a new `dash.js` instance is created and right before it's\n   * attached to media.\n   */\n  onInstance(callback) {\n    const instance = this.d.instance;\n    if (instance)\n      callback(instance);\n    this.d.pd.add(callback);\n    return () => this.d.pd.delete(callback);\n  }\n  destroy() {\n    this.d.destroy();\n  }\n}\n\nexport { DASHProvider };\n"],"names":["toDOMEventType","type","camelToKebabCase","DASHController","constructor","_video","_ctx","m","b","g","nd","od","pd","Set","Xo","_o","yk","instance","setup","ctor","create","dispatcher","So","bind","event","Object","values","events","on","ERROR","U","callback","player","dispatch","detail","initialize","updateSettings","streaming","text","defaultEnabled","dispatchForManualRendering","buffer","fastSwitchEnabled","FRAGMENT_LOADING_STARTED","bp","FRAGMENT_LOADING_COMPLETED","cp","MANIFEST_LOADED","Uo","QUALITY_CHANGE_RENDERED","fb","TEXT_TRACKS_ADDED","dp","TRACK_CHANGE_RENDERED","_d","qualities","QualitySymbol","Za","Yg","listenEvent","Yo","audioTracks","Zo","effect","_g","Wo","DOMEvent","$state","live","raf","RAFLoop","$g","Bb","ra","position","duration","time","liveSyncPosition","set","isNaN","Infinity","ep","native","TextTrackSymbol","T","cues","track","id","startIndex","trigger","i","length","cue","positionAlign","addCue","data","tracks","nativeTextTracks","textTracks","filter","textTrackInfo","nativeTextTrack","kind","TextTrack","label","labels","find","t","lang","language","default","defaultTrack","managed","M","Ua","mode","setTextTrack","add","mediaType","newMediaInfo","getById","index","ListSymbol","pa","quality","newQuality","canPlay","mediaPresentationDuration","delegate","c","Ya","media","getVideoElement","videoQualities","getTracksForTypeFromManifest","supportedVideoMimeType","map","e","mimeType","type2","canPlayVideoType","videoQuality","supportedAudioMimeType","canPlayAudioType","bitrateList","forEach","bitrate","toString","width","height","bandwidth","codec","oa","isNumber","audioTrack","localTrack","dispatchEvent","eventType","error","code","Ck","Ak","zk","requestAnimationFrame","play","window","setTimeout","clearTimeout","message","Ro","setQualityFor","selectedIndex","auto","abr","autoSwitchBitrate","selected","switch","IS_CHROME","currentTime","selectedTrack","getTracksFor","setCurrentTrack","H","loadSource","src","isString","attachSource","destroy","DASHLibLoader","_lib","_callback","W","Ca","bh","callbacks","onLoadStart","Ea","onLoaded","qd","onLoadError","ch","loadDASHScript","isUndefined","importDASH","dashjs","supportsMediaSource","coerceToError","loader","prototype","Function","Error","err","loadScript","isFunction","MediaPlayer","JS_DELIVR_CDN","DASHProvider","VideoProvider","arguments","$$PROVIDER_TYPE","Xe","d","video","Gb","supported","isDASHSupported","canLiveSync","config","library","preconnect","peek","source","preload","Bn","a","yn","V","onInstance","delete"],"mappings":"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","x_google_ignoreList":[0]}