import{aN as p,b7 as u,b8 as o,b9 as f,ba as d,aX as m,aW as n,aT as c,aV as g}from"./syncStore-BssUQgBy.js";import{H as k,a as P}from"./vidstack-BJhWhebu-B429KQl9.js";import"./routing-BmD2xUmi.js";import"./Link-Dg-h0Eyu.js";import"./components-BMGKah2q.js";import"./index-BnPmuIsI.js";import"./index-DPECAXpK.js";import"./index-Cb4tY8hP.js";import"./vidstack-CpkvFYuN-DVxRo5ek.js";class b{constructor(t,e){this.m=t,this.b=e,t.textTracks.onaddtrack=this.Wc.bind(this),d(this.cd.bind(this))}Wc(t){const e=t.track;if(!e||I(this.m,e))return;const i=new m({id:e.id,kind:e.kind,label:e.label??"",language:e.language,type:"vtt"});i[n.T]={track:e},i[n.M]=2,i[n.te]=!0;let r=0;const h=l=>{if(e.cues)for(let a=r;a<e.cues.length;a++)i.addCue(e.cues[a],l),r++};h(t),e.oncuechange=h,this.b.textTracks.add(i,t),i.setMode(e.mode,t)}cd(){this.m.textTracks.onaddtrack=null;for(const t of this.b.textTracks){const e=t[n.T]?.track;e?.oncuechange&&(e.oncuechange=null)}}}function I(s,t){return Array.from(s.children).find(e=>e.track===t)}class T{constructor(t,e){this.m=t,this.a=e,this.B=(i,r)=>{this.a.delegate.c("picture-in-picture-change",i,r)},c(this.m,"enterpictureinpicture",this.Jg.bind(this)),c(this.m,"leavepictureinpicture",this.Kg.bind(this))}get active(){return document.pictureInPictureElement===this.m}get supported(){return o(this.m)}async enter(){return this.m.requestPictureInPicture()}exit(){return document.exitPictureInPicture()}Jg(t){this.B(!0,t)}Kg(t){this.B(!1,t)}}class x{constructor(t,e){this.m=t,this.a=e,this.I="inline",c(this.m,"webkitpresentationmodechanged",this.Ua.bind(this))}get Se(){return u(this.m)}async kc(t){this.I!==t&&this.m.webkitSetPresentationMode(t)}Ua(t){const e=this.I;this.I=this.m.webkitPresentationMode,this.a.player?.dispatch(new g("video-presentation-change",{detail:this.I,trigger:t})),["fullscreen","picture-in-picture"].forEach(i=>{(this.I===i||e===i)&&this.a.delegate.c(`${i}-change`,this.I===i,t)})}}class y{constructor(t){this.fa=t}get active(){return this.fa.I==="fullscreen"}get supported(){return this.fa.Se}async enter(){this.fa.kc("fullscreen")}async exit(){this.fa.kc("inline")}}class v{constructor(t){this.fa=t}get active(){return this.fa.I==="picture-in-picture"}get supported(){return this.fa.Se}async enter(){this.fa.kc("picture-in-picture")}async exit(){this.fa.kc("inline")}}class R extends k{constructor(t,e){super(t,e),this.$$PROVIDER_TYPE="VIDEO",p(()=>{if(this.airPlay=new P(t,e),u(t)){const i=new x(t,e);this.fullscreen=new y(i),this.pictureInPicture=new v(i)}else o(t)&&(this.pictureInPicture=new T(t,e))},this.scope)}get type(){return"video"}setup(){super.setup(),f(this.video)&&new b(this.video,this.b),this.b.textRenderers.Fe(this.video),d(()=>{this.b.textRenderers.Fe(null)}),this.type==="video"&&this.b.delegate.c("provider-setup",this)}get video(){return this.a}}export{R as VideoProvider};
//# sourceMappingURL=vidstack-video-DJmD_cO0.js.map
