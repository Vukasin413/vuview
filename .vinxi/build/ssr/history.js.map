{"version":3,"file":"history.js","sources":["../../../src/components/ImportHistoryModal.tsx","../../../src/routes/library/history.tsx?pick=default&pick=$css"],"sourcesContent":["import { toaster } from \"@kobalte/core\";\nimport { batch, createEffect, createSignal, Show } from \"solid-js\";\nimport { HistoryItem, useSyncStore } from \"~/stores/syncStore\";\nimport Button from \"./Button\";\nimport Modal from \"./Modal\";\nimport { toast } from \"./Toast\";\nimport { getVideoId } from \"~/utils/helpers\";\n\nexport default function ImportHistoryModal(props: {\n  isOpen: boolean;\n  setIsOpen: (isOpen: boolean) => void;\n}) {\n  const [items, setItems] = createSignal([]);\n  const [index, setIndex] = createSignal(0);\n  const [success, setSuccess] = createSignal(0);\n  const [error, setError] = createSignal(0);\n  const [skipped, setSkipped] = createSignal(0);\n  let fileSelector: HTMLInputElement | undefined = undefined;\n  const itemsLength = () => items()?.length || 0;\n\n  function fileChange() {\n    if (!fileSelector?.files?.[0]) return;\n    const file = fileSelector.files[0];\n    file.text().then((text) => {\n      console.log(text);\n      setItems([]);\n      // Conduit\n      if (text.includes(\"conduit\")) {\n        const json = JSON.parse(text);\n        console.log(json);\n        const history = json.history;\n        console.log(history);\n        setItems(history);\n      }\n      // YouTube\n      else if (text.includes(\"products\") && text.includes(\"YouTube\")) {\n        const json = JSON.parse(text);\n        console.log(json);\n        const items = json.map((video: any) => {\n          const item = {\n            url: video.titleUrl.split(\"https://www.youtube.com\")[1],\n            title: video.title,\n            uploaderName: video.subtitles[0].name,\n            uploaderUrl: video.subtitles[0].url.split(\n              \"https://www.youtube.com\"\n            )[1],\n            watchedAt: new Date(video.time).getTime(),\n          };\n          console.log(item);\n          return item;\n        });\n        console.log(items);\n        setItems(\n          items.sort((a: any, b: any) => {\n            return b.watchedAt - a.watchedAt;\n          })\n        );\n      }\n      // LibreTube\n      else if (text.includes(\"watchPositions\")) {\n        console.log(\"LibreTube\");\n        const json = JSON.parse(text);\n        const lt = json.watchHistory.map((video: any) => {\n          return {\n            url: `/watch?v=${video.videoId}`,\n            duration: video.duration,\n            thumbnail: video.thumbnailUrl,\n            title: video.title,\n            uploaderName: video.uploader,\n            uploaderUrl: video.uploaderUrl,\n            uploaded: new Date(video.uploadDate).getTime(),\n            currentTime:\n              json.watchPositions.find((i: any) => i.videoId === video.videoId)\n                ?.position / 1000 ?? 0,\n          };\n        });\n        setItems(lt.sort((a: any, b: any) => b.watchedAt - a.watchedAt));\n      }\n\n      // Piped\n      else if (text.includes(\"watchHistory\")) {\n        const json = JSON.parse(text);\n        console.log(json);\n        const items = json.watchHistory.map((video: any) => {\n          const item = {\n            duration: video.duration,\n            url: video.url,\n            title: video.title,\n            uploaderName: video.uploaderName,\n            uploaderUrl: video.uploaderUrl,\n            watchedAt: video.watchedAt ?? 0,\n            currentTime: video.currentTime ?? 0,\n          };\n          return item;\n        });\n        setItems(items.sort((a: any, b: any) => b.watchedAt - a.watchedAt));\n      }\n\n      // FreeTube\n      else if (text.startsWith(`{\"videoId:`)) {\n        text = `[${text.replace(/\\n/g, \", \").slice(0, -2)}]`;\n        let json = JSON.parse(text);\n        console.log(json);\n        const ft = json\n          .map((video: any) => {\n            return {\n              duration: video.duration,\n              thumbnail: video.thumbnail,\n              title: video.title,\n              uploaderName: video.author,\n              uploaderUrl: video.authorUrl,\n              videoId: video.videoId,\n              watchedAt: video.watchedDate,\n              currentTime: video.currentTime,\n            };\n          })\n          .sort((a: any, b: any) => b.watchedAt - a.watchedAt);\n        setItems(ft);\n      }\n      // Invidious\n      else if (text.startsWith(`{\"subscriptions\":`)) {\n        const json = JSON.parse(text);\n        console.log(json);\n        const iv = json.watch_history.map((video: any) => {\n          return {\n            videoId: video,\n            watchedAt: 0,\n            currentTime: 0,\n          };\n        });\n        setItems(iv);\n      } else {\n        alert(\"Unsupported file\");\n      }\n      console.log(items());\n    });\n  }\n  const sync = useSyncStore();\n  async function handleImport(e: any) {\n    e.preventDefault();\n    e.stopPropagation();\n\n    const newItems: Record<string, HistoryItem>[] = [];\n    if (!sync.store) return;\n    for (const item of items() as HistoryItem[]) {\n      const id = getVideoId(item);\n      if (!id) {\n        setError(error() + 1);\n        setIndex(index() + 1);\n        continue;\n      }\n      const existing = sync.store.history[id];\n      if (existing) {\n        setIndex(index() + 1);\n        setSkipped(skipped() + 1);\n        continue;\n      }\n      newItems.push({ [id]: item });\n      setIndex(index() + 1);\n      setSuccess(success() + 1);\n    }\n    newItems.sort((a, b) => {\n      if (!a[Object.keys(a)[0]].watchedAt) return 1;\n      if (!b[Object.keys(b)[0]].watchedAt) return -1;\n      if (a[Object.keys(a)[0]].watchedAt > b[Object.keys(b)[0]].watchedAt)\n        return -1;\n      if (a[Object.keys(a)[0]].watchedAt < b[Object.keys(b)[0]].watchedAt)\n        return 1;\n      return 0;\n    });\n\n    const importHistory =async()=> new Promise<string>( (resolve) => {\n      batch(() => {\n        newItems.forEach((item) => {\n          sync.setStore(\"history\", item);\n        });\n      });\n      resolve(\"done\");\n    });\n    toast.promise(importHistory, {\n      loading: \"Importing history\",\n      success: (data) => {\n        return data;\n      },\n      error: () => {\n        return \"Error importing history\";\n      }\n    });\n    await importHistory()\n  }\n\n\n\n  return (\n    <Modal\n      title=\"Import History\"\n      isOpen={props.isOpen}\n      setIsOpen={props.setIsOpen}\n    >\n      <form>\n        <br />\n        <div>\n          <input ref={fileSelector} type=\"file\" onInput={fileChange} />\n        </div>\n        <textarea\n          class=\"text-black\"\n          onInput={(e) => {\n            // setV(e.currentTarget.value)\n            console.log(e.currentTarget.value);\n            setItems(JSON.parse(e.currentTarget.value).history);\n            console.log(items());\n          }}\n        />\n        <br />\n        <div>\n          <Show when={itemsLength() > 0}>\n            <strong>{`Found ${itemsLength()} items`}</strong>\n          </Show>\n        </div>{\" \"}\n        <div>\n          <progress value={index()} max={itemsLength()} />\n          <div>{`Success: ${success()} Error: ${error()} Skipped: ${skipped()}`}</div>\n        </div>\n        <div>\n          <button class=\"btn w-auto\" onClick={handleImport}>\n            Import\n          </button>\n          {/* <button class=\"btn w-auto\" onClick={deleteHistory}> */}\n          {/*   Delete */}\n          {/* </button> */}\n        </div>\n      </form>\n    </Modal>\n  );\n}\n","import {\n  For,\n  Show,\n  createEffect,\n  createSignal,\n  onMount,\n  useContext,\n  batch,\n  untrack,\n} from \"solid-js\";\nimport { RelatedStream } from \"~/types\";\nimport { HistoryItem, useSyncStore } from \"~/stores/syncStore\";\nimport { BsInfoCircleFill, BsXCircle } from \"solid-icons/bs\";\nimport Button from \"~/components/Button\";\nimport { toaster, Toast } from \"@kobalte/core\";\nimport { Portal } from \"solid-js/web\";\nimport useIntersectionObserver from \"~/hooks/useIntersectionObserver\";\nimport ImportHistoryModal from \"~/components/ImportHistoryModal\";\nimport uFuzzy from \"@leeoniya/ufuzzy\";\nimport Modal from \"~/components/Modal\";\nimport Field from \"~/components/Field\";\nimport { debounce, getVideoId } from \"~/utils/helpers\";\nimport VideoCard from \"~/components/content/stream/VideoCard\";\nimport { Title } from \"@solidjs/meta\";\n\nexport default function History() {\n  const [limit, setLimit] = createSignal(50);\n  const [items, setItems] = createSignal([]);\n  const sync = useSyncStore();\n  function deleteHistory() {\n    batch(() => {\n      Object.keys(sync.store.history).forEach((item) => {\n        sync.setStore(\"history\", item, undefined as any);\n      });\n    });\n  }\n\n  createEffect(() => {\n    if (!sync.store.history) return;\n    console.log(Object.keys(sync.store.history)?.length);\n  });\n  const [intersectionRef, setIntersectionRef] = createSignal<\n    HTMLDivElement | undefined\n  >(undefined);\n  const isIntersecting = useIntersectionObserver({\n    setTarget: () => intersectionRef(),\n  });\n  createEffect(() => {\n    if (isIntersecting()) {\n      setLimit((l) => l + 10);\n    }\n  });\n\n  const sort = (a: HistoryItem, b: HistoryItem) => {\n    const getTime = (date: number) => new Date(date).getTime();\n\n    if (!a.watchedAt) return 1;\n    if (!b.watchedAt) return -1;\n\n    const aTime = getTime(a.watchedAt);\n    const bTime = getTime(b.watchedAt);\n\n    // Check for invalid dates\n    if (isNaN(aTime)) return 1;\n    if (isNaN(bTime)) return -1;\n\n    // Check for dates before epoch time\n    if (aTime <= 0) return 1;\n    if (bTime <= 0) return -1;\n\n    return bTime - aTime;\n  };\n\n  const [history, setHistory] = createSignal<HistoryItem[]>([]);\n  const [importModalOpen, setImportModalOpen] = createSignal(false);\n  const [search, setSearch] = createSignal(\"\");\n\n  const setSearchDebounced = debounce((input: string) => {\n    setSearch(input);\n  }, 500);\n  const uf = new uFuzzy({\n    intraMode: 1,\n    intraChars: \"[w-]\",\n    intraSub: 1,\n    intraTrn: 1,\n    intraDel: 1,\n    intraIns: 1,\n  });\n\n  createEffect(() => {\n    if (search()) {\n      const strings = Object.values(sync.store.history).map(\n        (item) => `${item.title} ${item.uploaderName}`\n      );\n      const [idxs, info, sort] = uf.search(strings, search(), false);\n      const history = Object.values(sync.store.history);\n      const results = idxs?.map((idx) => history[idx])?.slice(0, limit()) ?? [];\n      setHistory(results);\n    } else {\n      if (!sync.store.history) return;\n      setHistory(\n        Object.values(sync.store.history).sort(sort).slice(0, limit())\n      );\n    }\n  });\n\n  const exportHistory = () => {\n    const history = Object.values(sync.store.history);\n    const toExport = JSON.stringify(\n      {\n        platform: \"Conduit\",\n        version: 1,\n        history,\n      },\n      null,\n      2\n    );\n    const blob = new Blob([toExport], { type: \"application/json\" });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    const fileName = `conduit-history-${new Date().toISOString()}.json`;\n    a.download = fileName;\n    a.click();\n    URL.revokeObjectURL(url);\n  };\n  const [deleteModalOpen, setDeleteModalOpen] = createSignal(false);\n  const [deleteConfirmInput, setDeleteConfirmInput] = createSignal(\"\");\n  const [touched, setTouched] = createSignal(false);\n  const [isLoading, setLoading] = createSignal(false);\n\n  return (\n    <div class=\"\">\n      <Title>History | Conduit</Title>\n      <Button label=\"Import\" onClick={() => setImportModalOpen(true)} />\n      <ImportHistoryModal\n        isOpen={importModalOpen()}\n        setIsOpen={(isOpen) => {\n          console.log(isOpen, \"setIsOpen\");\n          setImportModalOpen(isOpen);\n        }}\n      />\n      <Button label=\"Export\" onClick={exportHistory} />\n      <Button label=\"Clear\" onClick={() => setDeleteModalOpen(true)} />\n      <Modal\n        title=\"Delete history?\"\n        isOpen={deleteModalOpen()}\n        setIsOpen={setDeleteModalOpen}\n      >\n        <div class=\"flex flex-col items-center justify-center\">\n          <div class=\"text-sm text-text1\">This operation cannot be undone.</div>\n          <div class=\"flex mt-4 flex-col gap-2 items-center\">\n            <Field\n              class=\"ml-2\"\n              value={deleteConfirmInput()}\n              onInput={(v) => {\n                setTouched(false);\n                setDeleteConfirmInput(v);\n              }}\n              type=\"text\"\n              errorMessage={\n                deleteConfirmInput() !== \"DELETE\" && touched()\n                  ? \"Must type DELETE to confirm\"\n                  : \"\"\n              }\n              placeholder=\"DELETE\"\n              name=\"Type DELETE to confirm\"\n              validationState={\n                deleteConfirmInput() !== \"DELETE\" ? \"invalid\" : \"valid\"\n              }\n            />\n            <div class=\"flex gap-2\">\n              <Button\n                label=\"Cancel\"\n                onClick={() => setDeleteModalOpen(false)}\n              />\n              <Button\n                label=\"Delete\"\n                class=\"ml-2\"\n                onClick={() => {\n                  setTouched(true);\n                  if (deleteConfirmInput() === \"DELETE\") {\n                    deleteHistory();\n                    setDeleteModalOpen(false);\n                  }\n                }}\n              />\n            </div>\n          </div>\n        </div>\n      </Modal>\n      <Field\n        onInput={(e) => setSearchDebounced(e)}\n        class=\"my-2 mx-auto\"\n        placeholder=\"Search...\"\n      />\n      <div class=\"flex flex-wrap justify-center h-full min-h-[80vh]\">\n        <Show when={history()}>\n          <For each={history()}>\n            {(item) => (\n              <VideoCard\n                v={{\n                  ...item,\n                  url: `/watch?v=${getVideoId(item)}`,\n                }}\n              />\n            )}\n          </For>\n          <div\n            ref={(ref) => setIntersectionRef(ref)}\n            class=\"w-full h-20 mt-2\"\n          />\n        </Show>\n      </div>\n    </div>\n  );\n}\n"],"names":["ImportHistoryModal","props","items","setItems","createSignal","index","setIndex","success","setSuccess","error","setError","skipped","setSkipped","itemsLength","length","useSyncStore","_$createComponent","Modal","title","isOpen","setIsOpen","children","_$ssr","_tmpl$2","_$ssrHydrationKey","_$escape","Show","when","_tmpl$","_$ssrAttribute","History","limit","setLimit","sync","deleteHistory","batch","Object","keys","store","history","forEach","item","setStore","undefined","createEffect","console","log","intersectionRef","setIntersectionRef","isIntersecting","useIntersectionObserver","setTarget","l","sort","a","b","getTime","date","Date","watchedAt","aTime","bTime","isNaN","setHistory","importModalOpen","setImportModalOpen","search","setSearch","setSearchDebounced","debounce","input","uf","uFuzzy","intraMode","intraChars","intraSub","intraTrn","intraDel","intraIns","strings","values","map","uploaderName","idxs","info","results","idx","slice","exportHistory","toExport","JSON","stringify","platform","version","blob","Blob","type","url","URL","createObjectURL","document","createElement","href","fileName","toISOString","download","click","revokeObjectURL","deleteModalOpen","setDeleteModalOpen","deleteConfirmInput","setDeleteConfirmInput","touched","setTouched","_tmpl$3","Title","Button","label","onClick","Field","value","onInput","v","errorMessage","placeholder","name","validationState","e","For","each","VideoCard","getVideoId"],"mappings":"yiCAQA,SAAwBA,EAAmBC,EAGxC,CACD,KAAM,CAACC,EAAOC,CAAQ,EAAIC,EAAa,CAAE,CAAA,EACnC,CAACC,EAAOC,CAAQ,EAAIF,EAAa,CAAC,EAClC,CAACG,EAASC,CAAU,EAAIJ,EAAa,CAAC,EACtC,CAACK,EAAOC,CAAQ,EAAIN,EAAa,CAAC,EAClC,CAACO,EAASC,CAAU,EAAIR,EAAa,CAAC,EAEtCS,EAAcA,IAAMX,KAASY,QAAU,EAuHhCC,OAAAA,EAAa,EAwD1BC,EACGC,EAAK,CACJC,MAAK,iBAAA,IACLC,QAAM,CAAA,OAAElB,EAAMkB,MAAM,EAAA,IACpBC,WAAS,CAAA,OAAEnB,EAAMmB,SAAS,EAAA,IAAAC,UAAA,CAAA,OAAAC,EAAAC,EAAAC,EAAAC,EAAAA,EAAAT,EAkBrBU,EAAI,CAAA,IAACC,MAAI,CAAA,OAAEd,EAAgB,EAAA,CAAC,EAAA,IAAAQ,UAAA,CAAAC,OAAAA,EAAAM,EAAAJ,EAAA,EACjB,SAAMC,EAAEZ,EAAa,CAAA,CAAC,QAAO,CAAA,CAAA,CAAA,CAAA,EAAAgB,EAAAJ,QAAAA,EAIxBpB,EAAM,EAAC,EAAA,EAAA,EAAA,EAAAwB,EAAA,MAAAJ,EAAOZ,YACxB,YAASY,EAAElB,EAAQ,CAAC,CAAC,WAAQkB,EAAEhB,EAAM,CAAC,CAAC,aAAUgB,EAAEd,EAAQ,CAAC,CAAC,EAAC,CAAA,CAAA,CAAA,CAa/E,6jBCjNA,SAAwBmB,IAAU,CAChC,KAAM,CAACC,EAAOC,CAAQ,EAAI5B,EAAa,EAAE,EACfA,EAAa,CAAA,CAAE,EACzC,MAAM6B,EAAOlB,IACb,SAASmB,GAAgB,CACvBC,EAAM,IAAM,CACVC,OAAOC,KAAKJ,EAAKK,MAAMC,OAAO,EAAEC,QAAkBC,GAAA,CAC3CC,EAAAA,SAAS,UAAWD,EAAME,MAAiB,CAAA,CACjD,CAAA,CACF,CACH,CAEAC,EAAa,IAAM,CACZX,EAAKK,MAAMC,SAChBM,QAAQC,IAAIV,OAAOC,KAAKJ,EAAKK,MAAMC,OAAO,GAAGzB,MAAM,CAAA,CACpD,EACD,KAAM,CAACiC,EAAiBC,CAAkB,EAAI5C,EAE5CuC,MAAS,EACLM,EAAiBC,EAAwB,CAC7CC,UAAWA,IAAMJ,EAAgB,CAAA,CAClC,EACDH,EAAa,IAAM,CACbK,KACQG,EAAAA,GAAMA,EAAI,EAAE,CACxB,CACD,EAEKC,MAAAA,EAAOA,CAACC,EAAgBC,IAAmB,CAC/C,MAAMC,EAAWC,GAAiB,IAAIC,KAAKD,CAAI,EAAED,UAEjD,GAAI,CAACF,EAAEK,UAAkB,MAAA,GACzB,GAAI,CAACJ,EAAEI,UAAkB,MAAA,GAEnBC,MAAAA,EAAQJ,EAAQF,EAAEK,SAAS,EAC3BE,EAAQL,EAAQD,EAAEI,SAAS,EAGjC,OAAIG,MAAMF,CAAK,EAAU,EACrBE,MAAMD,CAAK,EAAU,GAGrBD,GAAS,EAAU,EACnBC,GAAS,EAAU,GAEhBA,EAAQD,CAAAA,EAGX,CAACrB,EAASwB,CAAU,EAAI3D,EAA4B,CAAE,CAAA,EACtD,CAAC4D,EAAiBC,CAAkB,EAAI7D,EAAa,EAAK,EAC1D,CAAC8D,EAAQC,CAAS,EAAI/D,EAAa,EAAE,EAErCgE,EAAqBC,EAAUC,GAAkB,CACrDH,EAAUG,CAAK,GACd,GAAG,EACAC,EAAK,IAAIC,EAAO,CACpBC,UAAW,EACXC,WAAY,OACZC,SAAU,EACVC,SAAU,EACVC,SAAU,EACVC,SAAU,CAAA,CACX,EAEDlC,EAAa,IAAM,CACjB,GAAIsB,IAAU,CACZ,MAAMa,EAAU3C,OAAO4C,OAAO/C,EAAKK,MAAMC,OAAO,EAAE0C,IAC/CxC,GAAU,GAAEA,EAAKvB,KAAM,IAAGuB,EAAKyC,YAAa,EAC/C,EACM,CAACC,EAAMC,EAAM/B,CAAI,EAAIkB,EAAGL,OAAOa,EAASb,IAAU,EAAK,EACvD3B,EAAUH,OAAO4C,OAAO/C,EAAKK,MAAMC,OAAO,EAC1C8C,EAAUF,GAAMF,IAAKK,GAAQ/C,EAAQ+C,CAAG,CAAC,GAAGC,MAAM,EAAGxD,EAAO,CAAA,GAAK,CAAA,EACvEgC,EAAWsB,CAAO,CAAA,KACb,CACD,GAAA,CAACpD,EAAKK,MAAMC,QAAS,OACzBwB,EACE3B,OAAO4C,OAAO/C,EAAKK,MAAMC,OAAO,EAAEc,KAAKA,CAAI,EAAEkC,MAAM,EAAGxD,EAAAA,CAAO,CAC/D,CACF,CAAA,CACD,EAED,MAAMyD,EAAgBA,IAAM,CAC1B,MAAMjD,EAAUH,OAAO4C,OAAO/C,EAAKK,MAAMC,OAAO,EAC1CkD,EAAWC,KAAKC,UACpB,CACEC,SAAU,UACVC,QAAS,EACTtD,QAAAA,CAAAA,EAEF,KACA,CACF,EACMuD,EAAO,IAAIC,KAAK,CAACN,CAAQ,EAAG,CAAEO,KAAM,kBAAA,CAAoB,EACxDC,EAAMC,IAAIC,gBAAgBL,CAAI,EAC9BxC,EAAI8C,SAASC,cAAc,GAAG,EACpC/C,EAAEgD,KAAOL,EACT,MAAMM,EAAY,mBAAkB,IAAI7C,KAAK,EAAE8C,aAAoB,QACnElD,EAAEmD,SAAWF,EACbjD,EAAEoD,MAAM,EACRR,IAAIS,gBAAgBV,CAAG,CAAA,EAEnB,CAACW,EAAiBC,CAAkB,EAAIzG,EAAa,EAAK,EAC1D,CAAC0G,EAAoBC,CAAqB,EAAI3G,EAAa,EAAE,EAC7D,CAAC4G,EAASC,CAAU,EAAI7G,EAAa,EAAK,EAChBA,OAAAA,EAAa,EAAK,EAElDkB,EAAA4F,GAAA1F,EAAAC,EAAAA,EAAAT,EAEKmG,EAAK,CAAA9F,SAAA,mBAAA,CAAA,CAAA,EAAAI,EAAAT,EACLoG,EAAM,CAACC,MAAK,SAAUC,QAASA,IAAMrD,EAAmB,EAAI,CAAC,CAAA,CAAA,EAAAxC,EAAAT,EAC7DhB,EAAkB,CAAA,IACjBmB,QAAM,CAAA,OAAE6C,EAAgB,CAAC,EACzB5C,UAAuBD,GAAA,CACb2B,QAAAA,IAAI3B,EAAQ,WAAW,EAC/B8C,EAAmB9C,CAAM,CAC3B,CAAC,CAAA,CAAA,EAAAM,EAAAT,EAEFoG,EAAM,CAACC,MAAK,SAAUC,QAAS9B,CAAa,CAAA,CAAA,EAAA/D,EAAAT,EAC5CoG,EAAM,CAACC,MAAK,QAASC,QAASA,IAAMT,EAAmB,EAAI,CAAC,CAAA,CAAA,EAAApF,EAAAT,EAC5DC,EAAK,CACJC,MAAK,kBAAA,IACLC,QAAM,CAAA,OAAEyF,EAAgB,CAAC,EACzBxF,UAAWyF,EAAkB,IAAAxF,UAAA,CAAA,OAAAC,EAAAM,EAAAJ,EAAAC,EAAAA,EAAAT,EAKxBuG,EAAK,CAAA,MAAA,OAAA,IAEJC,OAAK,CAAA,OAAEV,EAAmB,CAAC,EAC3BW,QAAgBC,GAAA,CACdT,EAAW,EAAK,EAChBF,EAAsBW,CAAC,CACzB,EACA1B,KAAI,OAAA,IACJ2B,cAAY,CAAA,OACVb,EAAmB,IAAM,UAAYE,EAAAA,EACjC,8BACA,EAAE,EAERY,YAAW,SACXC,KAAI,yBAAA,IACJC,iBAAe,CACbhB,OAAAA,EAAyB,IAAA,SAAW,UAAY,OAAO,CAAA,CAAA,CAAA,EAAArF,EAAAT,EAIxDoG,EAAM,CACLC,MAAK,SACLC,QAASA,IAAMT,EAAmB,EAAK,CAAC,CAAA,CAAA,EAAApF,EAAAT,EAEzCoG,EAAM,CACLC,MAAK,SAAA,MAAA,OAELC,QAASA,IAAM,CACbL,EAAW,EAAI,EACXH,MAAyB,WACb5E,IACd2E,EAAmB,EAAK,EAE5B,CAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EAAApF,EAAAT,EAMVuG,EAAK,CACJE,QAAgBrD,GAAAA,EAAmB2D,CAAC,EAAC,MAAA,eAErCH,YAAW,WAAA,CAAA,CAAA,EAAAnG,EAAAT,EAGVU,EAAI,CAAA,IAACC,MAAI,CAAA,OAAEY,EAAQ,CAAC,EAAA,IAAAlB,UAAA,CAAAL,MAAAA,CAAAA,EAClBgH,EAAG,CAAA,IAACC,MAAI,CAAA,OAAE1F,EAAQ,CAAC,EAAAlB,SACZL,GAAAA,EACHkH,EAAS,CAAA,IACRR,GAAC,CAAE,MAAA,CACD,GAAGjF,EACHwD,IAAM,YAAWkC,EAAW1F,CAAI,CAAE,EAAA,CACnC,CAAA,CAAA,CAEJ,CAAA,EAAAnB,EAAAC,GAAAC,EAAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAUb"}