{"version":3,"file":"PlaylistItem-DrQzDyGy.js","sources":["../../../../src/components/content/playlist/PlaylistItem.tsx"],"sourcesContent":["import numeral from \"numeral\";\nimport {\n  createEffect,\n  createRenderEffect,\n  createSignal,\n  onCleanup,\n  onMount,\n  useContext,\n} from \"solid-js\";\nimport { RelatedStream } from \"~/types\";\nimport {  useSyncStore } from \"~/stores/syncStore\";\nimport { generateThumbnailUrl, getVideoId } from \"~/utils/helpers\";\nimport { usePreferences } from \"~/stores/preferencesStore\";\nimport { createTimeAgo } from \"@solid-primitives/date\";\nimport Link from \"~/components/Link\";\n\nconst PlaylistItem = (props: {\n  v: RelatedStream;\n  index: number;\n  list: string;\n  active: string;\n}) => {\n  const [progress, setProgress] = createSignal<number | undefined>(undefined);\n  const sync = useSyncStore();\n  const [preferences] = usePreferences();\n\n  createRenderEffect(async () => {\n    const val = sync.store.playlists[props.list]?.relatedStreams?.find(\n      (v) => getVideoId(v) === getVideoId(props.v)\n    ) as any;\n    setProgress(val?.currentTime);\n  });\n  let card: HTMLAnchorElement | undefined = undefined;\n  onMount(() => {\n    console.log(\"effect\");\n    import(\"long-press-event\");\n    if (!card) return;\n    props.index;\n    props.active;\n    card.addEventListener(\"long-press\", (e) => {\n      e.preventDefault();\n      console.log(\"long press\");\n      setIsOpen(true);\n    });\n    card.addEventListener(\"contextmenu\", (e) => {\n      e.preventDefault();\n    });\n  });\n  onCleanup(() => {\n    if (!card) return;\n    card.removeEventListener(\"long-press\", () => {});\n    card.removeEventListener(\"contextmenu\", () => {});\n  });\n  const [isOpen, setIsOpen] = createSignal(false);\n  const [timeAgo] = createTimeAgo(props.v.uploaded, {interval: 1000 * 60 })\n\n  return (\n    <Link\n      // draggable=\"false\"\n      // data-long-press-delay=\"500\"\n      ref={card}\n      href={`${props.v.url}&list=${props.list}&index=${props.index}`}\n      // style={{ \"background-image\": `url(${props.v.thumbnail})` }}\n      class={`select-none relative min-h-[5rem] flex justify-between bg-bg2 hover:bg-bg1 px-1 focus-visible:ring-2 focus-visible:ring-accent1 outline-none mx-1 py-2 rounded-lg text-text1`}\n    >\n      <div\n        classList={{\n          \"bg-primary/50 \": parseInt(props.active) === props.index,\n        }}\n        class=\"absolute inset-0 w-full h-full bg-bg1/50 rounded-lg\"\n      ></div>\n      <div class=\"flex max-w-full w-full @container\">\n        <div\n          classList={{\n            \"bg-primary text-text3 \": parseInt(props.active) === props.index,\n            \"bg-bg2 text-text1\": parseInt(props.active) !== props.index,\n          }}\n          class=\"flex absolute aspect-square -top-2 -left-1  py-2 font-bold flex-col items-center justify-center h-4 rounded-md rounded-bl-none rounded-tr-none px-3 text-xs\"\n        >\n          {props.index}\n        </div>\n        <div class=\"shadow-xl my-auto w-0 min-w-[6rem] @[20rem]:min-w-[7rem] @[35rem]:min-w-[9rem] @[50rem]:min-w-[11rem]max-w-[6rem] @[20rem]:max-w-[7rem] @[35rem]:max-w-[9rem] @[50rem]:max-w-[11rem] aspect-video max-h-full rounded-lg \">\n          <img\n            class=\"object-cover w-full h-full max-w-full max-h-full rounded-lg \"\n            src={props.v.thumbnail}\n          />\n          {!!progress() && (\n            <div class=\"relative h-0 w-full\">\n              <div\n                style={{\n                  width: `clamp(0%, ${\n                    (progress()! / props.v.duration) * 100\n                  }%, 100%`,\n                }}\n                class=\"absolute bottom-0 h-1 bg-highlight\"\n              ></div>\n            </div>\n          )}\n          <div class=\"relative h-0 w-full bg-red-500 align-self-end\">\n            <div class=\"absolute bottom-1 right-1 text-xs @[20rem]:text-sm rounded bg-bg1/80 text-text1 px-1\">\n              {numeral(props.v.duration).format(\"00:00:00\").replace(/^0:/, \"\")}\n            </div>\n          </div>\n        </div>\n\n        <div class=\"px-2 max-w-full min-w-0\">\n          <div\n            // style={{\"text-shadow\": \"1px 1px 2px rgba(0,0,0,0.9)\"}}\n            class=\"max-h-10 min-w-0 font-bold max-w-full text-sm overflow-hidden overflow-ellipsis \"\n          >\n            {props.v.title}{\" \"}\n          </div>\n          <div class=\"truncate text-xs text-text2\">\n            <Link\n              href={props.v.uploaderUrl}\n              class=\"inline-block mr-1 link !text-text2\"\n            >\n              {props.v.uploaderName} •\n            </Link>\n            <div class=\"inline-block mr-1\">\n              {numeral(props.v.views).format(\"0a\").toUpperCase()} views •\n            </div>\n            <div class=\"inline-block mr-1\">\n              {timeAgo()}\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class=\"self-center justify-self-end ml-2\">\n        {/* <Dropdown */}\n        {/*   icon={ */}\n        {/*     <svg */}\n        {/*       xmlns=\"http://www.w3.org/2000/svg\" */}\n        {/*       width=\"16\" */}\n        {/*       height=\"16\" */}\n        {/*       fill=\"currentColor\" */}\n        {/*       class=\"text-text1 rounded-full w-6 h-6\" */}\n        {/*       viewBox=\"0 0 16 16\" */}\n        {/*     > */}\n        {/*       {\" \"} */}\n        {/*       <path d=\"M9.5 13a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0zm0-5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z\" />{\" \"} */}\n        {/*     </svg> */}\n        {/*   } */}\n        {/*   iconPosition=\"right\" */}\n        {/*   panelPosition=\"left\" */}\n        {/* > */}\n        {/*   <DropdownItem as=\"button\" label=\"Add to playlist\" /> */}\n        {/*   <DropdownItem as=\"button\" label=\"Add to queue\" /> */}\n        {/* </Dropdown> */}\n      </div>\n    </Link>\n  );\n};\n\nexport default PlaylistItem;\n"],"names":["PlaylistItem","props","progress","setProgress","createSignal","undefined","sync","useSyncStore","usePreferences","createRenderEffect","val","store","playlists","list","relatedStreams","find","v","getVideoId","currentTime","onMount","console","log","onCleanup","timeAgo","createTimeAgo","uploaded","interval","_$createComponent","Link","href","url","index","children","_$ssr","_tmpl$","_$ssrHydrationKey","parseInt","active","_tmpl$2","_$escape","_$ssrAttribute","thumbnail","_tmpl$4","duration","numeral","format","replace","title","uploaderUrl","uploaderName","views","toUpperCase","_tmpl$3","PlaylistItem$1"],"mappings":"4+CAgBA,MAAMA,EAAgBC,GAKhB,CACJ,KAAM,CAACC,EAAUC,CAAW,EAAIC,EAAiCC,MAAS,EACpEC,EAAOC,IACSC,EAAe,EAErCC,EAAmB,SAAY,CAC7B,MAAMC,EAAMJ,EAAKK,MAAMC,UAAUX,EAAMY,IAAI,GAAGC,gBAAgBC,KAC3DC,GAAMC,EAAWD,CAAC,IAAMC,EAAWhB,EAAMe,CAAC,CAC7C,EACAb,EAAYO,GAAKQ,WAAW,CAAA,CAC7B,EAEDC,EAAQ,IAAM,CACZC,QAAQC,IAAI,QAAQ,EACpB,OAAO,kBAAkB,CAWxB,CACF,EACDC,EAAU,IAAM,CAGkC,CACjD,EAC2BlB,EAAa,EAAK,EAC9C,KAAM,CAACmB,CAAO,EAAIC,EAAcvB,EAAMe,EAAES,SAAU,CAACC,SAAU,IAAO,EAAA,CAAI,EAExEC,OAAAA,EACGC,EAEC,CAAA,IAEAC,MAAI,CAAG,MAAA,GAAE5B,EAAMe,EAAEc,GAAI,SAAQ7B,EAAMY,IAAK,UAASZ,EAAM8B,KAAM,EAAC,EAAA,MAEtD,+KAA6K,IAAAC,UAAA,CAAA,MAAA,CAAAC,EAAAC,EAAAC,IAAA,GAI/JC,SAASnC,EAAMoC,MAAM,IAAMpC,EAAM8B,MAAKE,iBAAAA,EAAAA,sDAAAA,EAAAA,EAAAK,EAAAH,EAO5BC,EAAAA,GAAAA,SAASnC,EAAMoC,MAAM,IAAMpC,EAAM8B,MACtCK,yBAAAA,EAAAA,IAAAA,SAASnC,EAAMoC,MAAM,IAAMpC,EAAM8B,MAAK,oBAAA,EAAA,+JAAAQ,EAI5DtC,EAAM8B,KAAK,EAAAS,EAAA,MAAAD,EAKLtC,EAAMe,EAAEyB,UAAS,EAAA,EAAA,EAAA,EAEvB,CAAC,CAACvC,EAAS,GAAC+B,EAAAS,EAAAP,EAAAA,EAIG,mBACLI,EAAArC,IAAWqC,EAAAA,EAAAA,EAAGtC,EAAMe,EAAE2B,SAAY,EAAA,EAAA,GACpC,SAAQ,EAKhBJ,EAGIK,EAAQ3C,EAAMe,EAAE2B,QAAQ,EAAEE,OAAO,UAAU,EAAEC,QAAQ,MAAO,EAAE,CAAC,EAAAP,EAUjEtC,EAAMe,EAAE+B,KAAK,EAAAR,EAAAZ,EAGbC,EAAI,CAAA,IACHC,MAAI,CAAA,OAAE5B,EAAMe,EAAEgC,WAAW,EAAA,MAAA,qCAAA,IAAAhB,UAAA,CAAA,MAAA,CAGxB/B,EAAMe,EAAEiC,aAAY,IAAA,CAAA,CAAA,CAAA,CAAA,EAAAV,EAGpBK,EAAQ3C,EAAMe,EAAEkC,KAAK,EAAEL,OAAO,IAAI,EAAEM,aAAa,EAAAZ,EAGjDhB,GAAS,CAAAU,EAAAA,EAAAmB,EAAAjB,EAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CA6BxB,EAEAkB,EAAerD"}