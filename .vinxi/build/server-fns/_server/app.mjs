import{createComponent as n,isServer as z,getRequestEvent as pe,delegateEvents as Qe,mergeProps as _,Portal as Z,ssrElement as Ee,escape as a,ssr as v,ssrHydrationKey as b,ssrAttribute as P,ssrClassList as Ye}from"solid-js/web";import{F as Xe}from"./server-fns.mjs";import{children as Ze,createMemo as G,getOwner as et,untrack as De,Show as O,on as Le,createRoot as tt,createSignal as y,onCleanup as T,splitProps as F,createContext as ee,useContext as he,createUniqueId as ge,createEffect as C,For as B,onMount as ve,Switch as nt,Match as H,createRenderEffect as rt,Suspense as Se,ErrorBoundary as ot}from"solid-js";import{u as st,m as K,P as be,a as at,b as it,c as lt,M as ct,d as ut,e as dt,f as mt,g as ft,h as pt,D as ht,i as ue,j as gt,k as vt,l as bt,n as Te,o as le,p as wt,B as yt,q as ke,r as xt,s as $t,t as St,v as kt,w as Pt,T as Ct,x as It,y as Rt,z as Ot,A as te,C as W,E as we,F as Et,G as Dt,V as Lt,H as Tt,I as At,J as Mt,K as _t,L as Ae,N as Ft,O as jt,Q as Nt,R as Kt,S as Ut,U as qt,W as zt,X as Bt}from"./Toast.mjs";import{createStore as Me}from"solid-js/store";import{u as J,L as de,A as Vt}from"./Link.mjs";import{I as ne}from"./index2.mjs";import{createQuery as _e,QueryClient as Wt,QueryClientProvider as Ht,isServer as Gt}from"@tanstack/solid-query";import{M as Jt}from"./index3.mjs";import{T as Fe,a as Qt,b as Yt,c as Pe,B as Xt,d as Zt,e as en}from"./index4.mjs";import{c as tn,a as nn,R as rn,b as on,d as sn,g as Ce,m as an,k as ln,s as cn,e as un,n as dn,u as ye,f as xe,h as je,i as mn}from"./routing.mjs";import{F as fn,a as pn,b as hn,c as gn}from"./index5.mjs";import{F as ce}from"./Field.mjs";import"solid-js/web/storage";import"h3";import"node:async_hooks";import"y-webrtc";import"yjs";import"lib0/observable";import"numeral";import"@solid-primitives/date";import"./components.mjs";const Ne=e=>r=>{const{base:t}=r,o=Ze(()=>r.children),s=G(()=>tn(o(),r.base||""));let i;const l=nn(e,s,()=>i,{base:t,singleFlight:r.singleFlight});return e.create&&e.create(l),n(rn.Provider,{value:l,get children(){return n(vn,{routerState:l,get root(){return r.root},get load(){return r.rootLoad},get children(){return[(i=et())&&null,n(bn,{routerState:l,get branches(){return s()}})]}})}})};function vn(e){const r=e.routerState.location,t=e.routerState.params,o=G(()=>e.load&&De(()=>e.load({params:t,location:r,intent:"preload"})));return n(O,{get when(){return e.root},keyed:!0,get fallback(){return e.children},children:s=>n(s,{params:t,location:r,get data(){return o()},get children(){return e.children}})})}function bn(e){if(z){const s=pe();if(s&&s.router&&s.router.dataOnly){wn(s,e.routerState,e.branches);return}s&&((s.router||(s.router={})).matches||(s.router.matches=e.routerState.matches().map(({route:i,path:l,params:d})=>({path:i.originalPath,pattern:i.pattern,match:l,params:d,info:i.info}))))}const r=[];let t;const o=G(Le(e.routerState.matches,(s,i,l)=>{let d=i&&s.length===i.length;const u=[];for(let p=0,$=s.length;p<$;p++){const S=i&&i[p],w=s[p];l&&S&&w.route.key===S.route.key?u[p]=l[p]:(d=!1,r[p]&&r[p](),tt(f=>{r[p]=f,u[p]=on(e.routerState,u[p-1]||e.routerState.base,Ie(()=>o()[p+1]),()=>e.routerState.matches()[p])}))}return r.splice(s.length).forEach(p=>p()),l&&d?l:(t=u[0],u)}));return Ie(()=>o()&&t)()}const Ie=e=>()=>n(O,{get when(){return e()},keyed:!0,children:r=>n(sn.Provider,{value:r,get children(){return r.outlet()}})});function wn(e,r,t){const o=new URL(e.request.url),s=Ce(t,new URL(e.router.previousUrl||e.request.url).pathname),i=Ce(t,o.pathname);for(let l=0;l<i.length;l++){(!s[l]||i[l].route!==s[l].route)&&(e.router.dataOnly=!0);const{route:d,params:u}=i[l];d.load&&d.load({params:u,location:r.location,intent:"preload"})}}function yn([e,r],t,o){return[t?()=>t(e()):e,o?s=>r(o(s)):r]}function xn(e){if(e==="#")return null;try{return document.querySelector(e)}catch{return null}}function $n(e){let r=!1;const t=s=>typeof s=="string"?{value:s}:s,o=yn(y(t(e.get()),{equals:(s,i)=>s.value===i.value}),void 0,s=>(!r&&e.set(s),s));return e.init&&T(e.init((s=e.get())=>{r=!0,o[1](t(s)),r=!1})),Ne({signal:o,create:e.create,utils:e.utils})}function Sn(e,r,t){return e.addEventListener(r,t),()=>e.removeEventListener(r,t)}function kn(e,r){const t=xn(`#${e}`);t?t.scrollIntoView():r&&window.scrollTo(0,0)}function Pn(e){const r=new URL(e);return r.pathname+r.search}function Cn(e){let r;const t={value:e.url||(r=pe())&&Pn(r.request.url)||""};return Ne({signal:[()=>t,o=>Object.assign(t,o)]})(e)}const In=new Map;function Rn(e=!0,r=!1,t="/_server"){return o=>{const s=o.base.path(),i=o.navigatorFactory(o.base);let l={};function d(m){return m.namespaceURI==="http://www.w3.org/2000/svg"}function u(m){if(m.defaultPrevented||m.button!==0||m.metaKey||m.altKey||m.ctrlKey||m.shiftKey)return;const g=m.composedPath().find(D=>D instanceof Node&&D.nodeName.toUpperCase()==="A");if(!g||r&&!g.hasAttribute("link"))return;const x=d(g),k=x?g.href.baseVal:g.href;if((x?g.target.baseVal:g.target)||!k&&!g.hasAttribute("state"))return;const I=(g.getAttribute("rel")||"").split(/\s+/);if(g.hasAttribute("download")||I&&I.includes("external"))return;const L=x?new URL(k,document.baseURI):new URL(k);if(!(L.origin!==window.location.origin||s&&L.pathname&&!L.pathname.toLowerCase().startsWith(s.toLowerCase())))return[g,L]}function p(m){const g=u(m);if(!g)return;const[x,k]=g,E=o.parsePath(k.pathname+k.search+k.hash),I=x.getAttribute("state");m.preventDefault(),i(E,{resolve:!1,replace:x.hasAttribute("replace"),scroll:!x.hasAttribute("noscroll"),state:I&&JSON.parse(I)})}function $(m){const g=u(m);if(!g)return;const[x,k]=g;l[k.pathname]||o.preloadRoute(k,x.getAttribute("preload")!=="false")}function S(m){const g=u(m);if(!g)return;const[x,k]=g;l[k.pathname]||(l[k.pathname]=setTimeout(()=>{o.preloadRoute(k,x.getAttribute("preload")!=="false"),delete l[k.pathname]},200))}function w(m){const g=u(m);if(!g)return;const[,x]=g;l[x.pathname]&&(clearTimeout(l[x.pathname]),delete l[x.pathname])}function f(m){let g=m.submitter&&m.submitter.hasAttribute("formaction")?m.submitter.getAttribute("formaction"):m.target.getAttribute("action");if(!g)return;if(!g.startsWith("https://action/")){const k=new URL(g,an);if(g=o.parsePath(k.pathname+k.search),!g.startsWith(t))return}if(m.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const x=In.get(g);if(x){m.preventDefault();const k=new FormData(m.target);m.submitter&&m.submitter.name&&k.append(m.submitter.name,m.submitter.value),x.call({r:o,f:m.target},k)}}Qe(["click","submit"]),document.addEventListener("click",p),e&&(document.addEventListener("mouseover",S),document.addEventListener("mouseout",w),document.addEventListener("focusin",$),document.addEventListener("touchstart",$)),document.addEventListener("submit",f),T(()=>{document.removeEventListener("click",p),e&&(document.removeEventListener("mouseover",S),document.removeEventListener("mouseout",w),document.removeEventListener("focusin",$),document.removeEventListener("touchstart",$)),document.removeEventListener("submit",f)})}}function On(e){if(z)return Cn(e);const r=()=>({value:window.location.pathname+window.location.search+window.location.hash,state:window.history.state}),t=un();return $n({get:r,set({value:o,replace:s,scroll:i,state:l}){s?window.history.replaceState(ln(l),"",o):window.history.pushState(l,"",o),kn(window.location.hash.slice(1),i),cn()},init:o=>Sn(window,"popstate",dn(o,s=>{if(s&&s<0)return!t.confirm(s);{const i=r();return!t.confirm(i.value,{state:i.state})}})),create:Rn(e.preload,e.explicitLinks,e.actionBase),utils:{go:o=>window.history.go(o),beforeLeave:t}})(e)}function En(e){const r=st();return e=K({children:"â–¼"},e),n(be,_({as:"span","aria-hidden":"true"},()=>r.dataset(),e))}function Dn(e){const r=at();e=K({id:r.generateId("indicator")},e);const[t,o]=F(e,["forceMount"]);return n(O,{get when(){return t.forceMount||r.isChecked()},get children(){return n(be,_({as:"div"},()=>r.dataset(),o))}})}const Ke=ee();function Ln(){const e=he(Ke);if(e===void 0)throw new Error("[kobalte]: `useMenuRadioGroupContext` must be used within a `Menu.RadioGroup` component");return e}function Tn(e){const t=it().generateId(`radiogroup-${ge()}`);e=K({id:t},e);const[o,s]=F(e,["value","defaultValue","onChange","disabled"]),[i,l]=lt({value:()=>o.value,defaultValue:()=>o.defaultValue,onChange:u=>o.onChange?.(u)}),d={isDisabled:()=>o.disabled,isSelectedValue:u=>u===i(),setSelectedValue:l};return n(Ke.Provider,{value:d,get children(){return n(ct,s)}})}function An(e){const r=Ln();e=K({closeOnSelect:!1},e);const[t,o]=F(e,["value","onSelect"]);return n(ut,_({role:"menuitemradio",get checked(){return r.isSelectedValue(t.value)},onSelect:()=>{t.onSelect?.(),r.setSelectedValue(t.value)}},o))}const Ue=ee();function re(){const e=he(Ue);if(e===void 0)throw new Error("[kobalte]: `usePopoverContext` must be used within a `Popover` component");return e}function Mn(e){let r;const t=re();e=K({id:t.generateId("content")},e);const[o,s]=F(e,["ref","style","onOpenAutoFocus","onCloseAutoFocus","onPointerDownOutside","onFocusOutside","onInteractOutside"]);let i=!1,l=!1,d=!1;const u=w=>{o.onCloseAutoFocus?.(w),t.isModal()?(w.preventDefault(),i||ue(t.triggerRef())):(w.defaultPrevented||(l||ue(t.triggerRef()),w.preventDefault()),l=!1,d=!1)},p=w=>{o.onPointerDownOutside?.(w),t.isModal()&&(i=w.detail.isContextMenu)},$=w=>{o.onFocusOutside?.(w),t.isOpen()&&t.isModal()&&w.preventDefault()},S=w=>{o.onInteractOutside?.(w),!t.isModal()&&(w.defaultPrevented||(l=!0,w.detail.originalEvent.type==="pointerdown"&&(d=!0)),gt(t.triggerRef(),w.target)&&w.preventDefault(),w.detail.originalEvent.type==="focusin"&&d&&w.preventDefault())};return dt({isDisabled:()=>!(t.isOpen()&&t.isModal()),targets:()=>[]}),mt({ownerRef:()=>r,isDisabled:()=>!(t.isOpen()&&(t.isModal()||t.preventScroll()))}),ft({trapFocus:()=>t.isOpen()&&t.isModal(),onMountAutoFocus:o.onOpenAutoFocus,onUnmountAutoFocus:u},()=>r),C(()=>T(t.registerContentId(s.id))),n(O,{get when(){return t.contentPresence.isPresent()},get children(){return n(pt,{get children(){return n(ht,_({role:"dialog",tabIndex:-1,get disableOutsidePointerEvents(){return t.isOpen()&&t.isModal()},get excludedElements(){return[t.triggerRef]},get style(){return{"--kb-popover-content-transform-origin":"var(--kb-popper-content-transform-origin)",position:"relative",...o.style}},get"aria-labelledby"(){return t.titleId()},get"aria-describedby"(){return t.descriptionId()},onPointerDownOutside:p,onFocusOutside:$,onInteractOutside:S,get onDismiss(){return t.close}},()=>t.dataset(),s))}})}})}function _n(e){const r=re();e=K({id:r.generateId("description")},e);const[t,o]=F(e,["id"]);return C(()=>T(r.registerDescriptionId(t.id))),n(be,_({as:"p",get id(){return t.id}},()=>r.dataset(),o))}function Fn(e){const r=re();return n(O,{get when(){return r.contentPresence.isPresent()},get children(){return n(Z,e)}})}function jn(e){const r=`popover-${ge()}`;e=K({id:r,modal:!1,preventScroll:!1},e);const[t,o]=F(e,["id","open","defaultOpen","onOpenChange","modal","preventScroll","forceMount","anchorRef"]),[s,i]=y(),[l,d]=y(),[u,p]=y(),[$,S]=y(),[w,f]=y(),[m,g]=y(),x=vt({open:()=>t.open,defaultOpen:()=>t.defaultOpen,onOpenChange:D=>t.onOpenChange?.(D)}),k=()=>t.anchorRef?.()??s()??l(),E=bt(()=>t.forceMount||x.isOpen()),L={dataset:G(()=>({"data-expanded":x.isOpen()?"":void 0,"data-closed":x.isOpen()?void 0:""})),isOpen:x.isOpen,isModal:()=>t.modal??!1,preventScroll:()=>t.preventScroll??!1,contentPresence:E,triggerRef:l,contentId:$,titleId:w,descriptionId:m,setDefaultAnchorRef:i,setTriggerRef:d,setContentRef:p,close:x.close,toggle:x.toggle,generateId:Te(()=>t.id),registerContentId:le(S),registerTitleId:le(f),registerDescriptionId:le(g)};return n(Ue.Provider,{value:L,get children(){return n(wt,_({anchorRef:k,contentRef:u},o))}})}function Nn(e){const r=re(),[t,o]=F(e,["ref","onClick","onPointerDown"]);return n(yt,_({"aria-haspopup":"dialog",get"aria-expanded"(){return r.isOpen()},get"aria-controls"(){return r.isOpen()?r.contentId():void 0},onPointerDown:l=>{ke(l,t.onPointerDown),l.preventDefault()},onClick:l=>{ke(l,t.onClick),r.toggle()}},()=>r.dataset(),o))}function Kn(e){let r;const t=xt(),[o,s]=F(e,["ref","onFocusIn","onFocusOut","onPointerMove","onPointerLeave"]);return C(Le([()=>r,()=>t.hotkey()],([i,l])=>{if(z||!i)return;const d=$t(i),u=p=>{l.every(S=>p[S]||p.code===S)&&ue(i)};d.addEventListener("keydown",u),T(()=>d.removeEventListener("keydown",u))})),C(()=>{if(!t.pauseOnPageIdle())return;const i=St(r);i.addEventListener("blur",t.pauseAllTimer),i.addEventListener("focus",t.resumeAllTimer),T(()=>{i.removeEventListener("blur",t.pauseAllTimer),i.removeEventListener("focus",t.resumeAllTimer)})}),Ee("ol",_({tabIndex:-1},s),()=>a(n(B,{get each(){return t.toasts()},children:i=>i.toastComponent({get toastId(){return i.id}})})),!0)}function Un(e){const r=`toast-region-${ge()}`;e=K({id:r,hotkey:["altKey","KeyT"],duration:5e3,limit:3,swipeDirection:"right",swipeThreshold:50,pauseOnInteraction:!0,pauseOnPageIdle:!0,topLayer:!0},e);const[t,o]=F(e,["style","hotkey","duration","limit","swipeDirection","swipeThreshold","pauseOnInteraction","pauseOnPageIdle","topLayer","aria-label","regionId"]),s=G(()=>kt.toasts().filter(f=>f.region===t.regionId).slice(0,t.limit)),[i,l]=y(!1),d=Pt(()=>Ct),u=()=>s().length>0,p=()=>t.hotkey.join("+").replace(/Key/g,"").replace(/Digit/g,""),$=()=>(t["aria-label"]||d().format("notifications",{hotkey:p()})).replace(Rt,p()),S=()=>({[Ot]:t.topLayer?"":void 0}),w={isPaused:i,toasts:s,hotkey:()=>t.hotkey,duration:()=>t.duration,swipeDirection:()=>t.swipeDirection,swipeThreshold:()=>t.swipeThreshold,pauseOnInteraction:()=>t.pauseOnInteraction,pauseOnPageIdle:()=>t.pauseOnPageIdle,pauseAllTimer:()=>l(!0),resumeAllTimer:()=>l(!1),generateId:Te(()=>o.id)};return n(It.Provider,{value:w,get children(){return Ee("div",_({role:"region",tabIndex:-1,get"aria-label"(){return $()},get style(){return{"pointer-events":u()?t.topLayer?"auto":void 0:"none",...t.style}}},S,o),void 0,!0)}})}async function qn(e,r){const t=await fetch(e),o=zn(await t.text(),r),s=new Blob([o],{type:"text/plain"});return{srtUrl:URL.createObjectURL(s),srtText:o}}function zn(e,r){const t=e.match(/ttp:frameRate="(\d+)"/),o=e.match(/ttp:frameRateMultiplier="(\d+) (\d+)"/),s=t?parseInt(t[1],10):0,i=o?parseInt(o[1],10):1,l=o?parseInt(o[2],10):1;let d=s*i/l;d=r??d,Number.isInteger(d)||(d=parseFloat(d.toFixed(3)));const u=e.match(/ttp:frameRate="ttp:subFrameRate="(\d+)"/),p=u?parseInt(u[1],10):1,$=e.match(/ttp:tickRate="(\d+)"/),S=$?parseInt($[1],10):1,w=d>0?d:`UNKNOWN
[WARN] TIMING MAY BE INCORRECT`;console.info(`[INFO] FRAMERATE IS ${w}`);let f="",m=0,g="",x="";const k=new RegExp("<p (.*?)>(.*?)</p>","g");let E;for(;(E=k.exec(e))!==null;){const[I,L,D]=E,j=L.trim().match(/[^\s]*="?[^"]*/g).map(M=>M.split("=")).reduce((M,[oe,se])=>(M[oe]=(se||"").replace(/^"/,""),M),{});if(!j.begin||!j.end){console.warn("[WARN] Some string was not parsed, start/end time attribute was missing!");continue}const c=Re(j.begin,d,p,S),R=Re(j.end,d,p,S),A=D.replace(/<\/br>/g,"").replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/<span>(.*?)<\/span>/g,"$1").replace(/(<br.*?>)+/g,`\r
`).replace(/<[^>]*\/>/g,"").replace(/<(\S*?) (.*?)>(.*?)<\/.*?>/g,Bn);A.trim()!==""&&(x=`${c} --> ${R}`,g!==x?(g=x,m++,f!==""&&(f+=`\r
\r
`),f+=`${m}\r
${x}\r
`):f+=`\r
`,f+=A)}return f+=`\r
\r
`,`\uFEFF${f}`}function Re(e,r,t,o){let s=e.match(/(\d*:\d*:\d*)(.*)$/);if(!s){s=e.match(/([0-9.]*)(.*)/);const l={h:3600,m:60,s:1,ms:.001,f:1/r,t:1/o};let d=parseFloat(s[1])*l[s[2]||""],u=Math.floor(d/3600).toString().padStart(2,"0"),p=Math.floor(d%3600/60).toString().padStart(2,"0"),$=Math.floor(d%60).toString().padStart(2,"0"),S=Math.round((d-Math.floor(d))*1e3).toString().padEnd(3,"0").slice(0,3);return`${u}:${p}:${$},${S}`}let i=s[2]||"";if(i.length===0)return`${s[1]},000`;if(i[0]==="."){let l=i.slice(1).padEnd(3,"0").slice(0,3);return`${s[1]},${l}`}if(i[0]===":"){let l=i.slice(1).split("."),d=parseInt(l[0]);l.length>1&&(d+=parseInt(l[1])/t);let u=Math.floor(d*1e3/r).toString().padEnd(3,"0").slice(0,3);return`${s[1]},${u}`}return`${s[1]},000`}function Bn(e,r,t,o){if(r!=="span")return o;const s=t.replace(/\s*=\s*/g,"=").split(" ").filter(l=>l.trim()),i={};for(const l of s){let d;if(d=l.match(/tts:color="(.*?)"/)){i.color=d[1];continue}switch(l){case'tts:fontStyle="italic"':i.fontStyle="italic";break;case'tts:textDecoration="underline"':i.textDecoration="underline";break;case'tts:fontWeight="bold"':i.fontWeight="bold";break}}return i.color&&(o=`<font color="${i.color}">${o.trim()}</font>`),i.fontStyle&&(o=`<i>${o.trim()}</i>`),i.textDecoration&&(o=`<u>${o.trim()}</u>`),i.fontWeight&&(o=`<b>${o.trim()}</b>`),o}const Vn="_controls_1xob6_1",Wn={controls:Vn};var Hn=["<media-tooltip","><media-tooltip-trigger>",'</media-tooltip-trigger><media-tooltip-content class="','"',">","</media-tooltip-content></media-tooltip>"];function Gn(e){const r=()=>e.placement.includes("bottom");return v(Hn,b()+P("class",a(e.class,!0),!1),a(e.triggerSlot),`tooltip animate-out fade-out slide-out-to-bottom-2 data-[visible]:animate-in data-[visible]:fade-in data-[visible]:slide-in-from-bottom-4 z-10 rounded-sm bg-black/90 px-2 py-0.5 text-sm font-medium text-white ${r()?"!top-12":""}`,P("placement",a(e.placement,!0),!1),a(e.contentSlot))}var Jn=["<media-play-button",' class="ring-primary relative inline-flex h-10 w-10 cursor-pointer items-center justify-center rounded-md outline-none ring-inset hover:bg-white/20 data-[focus]:ring-4"><media-icon class="media-paused:block hidden h-8 w-8" type="play"></media-icon><media-icon class="media-paused:hidden h-8 w-8" type="pause"></media-icon></media-play-button>'],Qn=["<span",' class="media-paused:block hidden">Play</span>'],Yn=["<span",' class="media-paused:hidden">Pause</span>'];function Xn(e){return n(Gn,{get placement(){return e.tooltipPlacement},get triggerSlot(){return v(Jn,b())},get contentSlot(){return[v(Qn,b()),v(Yn,b())]}})}const Zn="_captions_jw0nu_1",er={captions:Zn};var tr=["<media-captions",' class="','"></media-captions>'];function nr(){return v(tr,b(),`${a(er.captions,!0)} media-preview:opacity-0 media-controls:bottom-[85px] media-captions:opacity-100 absolute inset-0 bottom-2 z-10 select-none break-words opacity-0 transition-[opacity,bottom] duration-300`)}var rr=["<media-gesture",' class="absolute inset-0 z-0 block h-full w-full" event="dblpointerup" action="toggle:paused"></media-gesture>'],or=["<media-gesture",' class="absolute inset-0 z-0 block h-full w-full" event="pointerup" action="toggle:controls"></media-gesture>'],sr=["<media-gesture",' class="absolute left-0 top-0 z-10 block h-full w-1/5" event="dblpointerup" action="seek:-10"></media-gesture>'],ar=["<media-gesture",' class="absolute right-0 top-0 z-10 block h-full w-1/5" event="dblpointerup" action="seek:10"></media-gesture>'];function ir(){return[v(rr,b()),v(or,b()),v(sr,b()),v(ar,b())]}var lr=["<media-slider-chapters",' class="relative flex h-full w-full items-center rounded-[1px]"><template>',"</template></media-slider-chapters>"],cr=["<div",' class="last-child:mr-0 relative mr-0.5 flex h-full w-full items-center rounded-[1px]" style="','"><div class="ring-primary relative z-0 h-[5px] w-full rounded-sm bg-white/30 group-data-[focus]:ring-[3px]"><div class="bg-primary z-10 absolute h-full w-[var(--chapter-fill)] rounded-sm will-change-[width]"></div><div class="absolute z-0 h-full w-[var(--chapter-progress)] rounded-sm bg-white/50 will-change-[width]"></div></div></div>'];function ur(){return v(lr,b(),a(n(dr,{})))}function dr(){return v(cr,b(),"contain:layout style")}var mr=["<media-slider-thumbnail",' class="block h-[var(--thumbnail-height)] max-h-[160px] min-h-[80px] w-[var(--thumbnail-width)] min-w-[120px] max-w-[180px] overflow-hidden border border-white bg-black"',"></media-slider-thumbnail>"],fr=["<media-slider-preview",' class="flex flex-col pointer-events-none items-center opacity-0 transition-opacity duration-200 data-[visible]:opacity-100"',"><!--$-->","<!--/--><!--$-->","<!--/--></media-slider-preview>"];function pr(e){return v(fr,b(),P("noclamp",a(e?.noClamp,!0),!1),a(n(O,{get when(){return e?.thumbnails},get children(){return v(mr,b(),P("src",a(e?.thumbnails,!0),!1))}})),a(e?.children))}var hr=["<div",' class="absolute left-[var(--slider-fill)] top-1/2 z-20 h-[15px] w-[15px] -translate-x-1/2 -translate-y-1/2 rounded-full border border-[#cacaca] bg-white opacity-0 ring-white/40 transition-opacity group-data-[active]:opacity-100 group-data-[dragging]:ring-4 will-change-[left]"></div>'];function gr(){return v(hr,b())}var vr=["<div",' class="mt-2 text-sm" data-part="chapter-title"></div>'],br=["<media-slider-value",' class="text-[13px]" type="pointer" format="time"></media-slider-value>'],wr=["<media-time-slider",' class="group relative mx-[7.5px] inline-flex h-1 mb-2 py-2 w-full cursor-pointer touch-none select-none items-center outline-none"><!--$-->',"<!--/--><!--$-->","<!--/--><!--$-->","<!--/--></media-time-slider>"];function yr(e){return v(wr,b(),a(n(ur,{})),a(n(gr,{})),a(n(pr,{get thumbnails(){return e.thumbnails},get children(){return[v(vr,b()),v(br,b())]}})))}var xr=["<div",' class="','"><!--$-->',"<!--/--><!--$-->",'<!--/--><media-controls class="','"><div class="flex-1"></div><media-controls-group class="flex w-full items-center px-2">','</media-controls-group><media-controls-group class="-mt-0.5 flex w-full items-center px-2 pb-2">',"</media-controls-group></media-controls></div>"];function $r(e){return v(xr,b(),Ye(e.classList),a(n(ir,{})),a(n(nr,{})),`${a(Wn.controls,!0)} font-sans media-controls:opacity-100 invisible media-controls:visible  absolute inset-0 z-10 flex h-full w-full flex-col bg-gradient-to-t from-black/10 to-transparent opacity-0 transition-opacity`,a(n(yr,{get thumbnails(){return e.thumbnails}})),a(n(Xn,{tooltipPlacement:"top start"})))}var Sr=["<div",' class="','"><div class="flex items-center justify-between h-4">',"</div></div>"];function kr(){const[e,r]=J(),t=ye(),[o,s]=y(void 0),[i]=xe();return te(),C(()=>{console.log(i.v,"searchParams.v"),i.v&&s(i.v)}),v(Sr,b(),e.player.dismissed||!e.player.small?"hidden":"",a(n(W,{appearance:"subtle",class:"hover:bg-white/20 rounded-md p-0 h-10 w-10 flex items-center justify-center",get icon(){return n(Fe,{class:"text-white w-8 h-8 min-w-max"})},onClick:()=>{o()&&t(`/watch?v=${o()}`)}})))}var Pr=["<div",' class="absolute z-50 top-0 right-0 w-full h-full opacity-100 pointer-events-auto bg-black/50"><div class="flex flex-col items-center justify-center w-full h-full gap-3"><div class="text-2xl font-bold text-white"><!--$-->',"<!--/--> <!--$-->",'<!--/--></div><div class="flex flex-col"><div class="text-lg text-white">','</div><div class="text-lg text-white">Please try switching to a different instance or refresh the page.</div></div><div class="flex justify-center gap-2"><button class="px-4 py-2 text-lg text-white border border-white rounded-md">Close</button></div></div></div>'],Cr=["<div",' class="absolute z-50 top-0 right-0 w-full h-full pointer-events-auto"><div class="flex flex-col items-center justify-center w-full h-full gap-3"><div class="text-2xl font-bold text-white">Playing next in <!--$-->','<!--/--> seconds</div><div class="flex flex-col"><div class="text-lg scale-75 sm:scale-100 text-white w-96 h-full my-2">','</div></div><div class="flex justify-center gap-2"><!--$-->',"<!--/--><!--$-->","<!--/--></div></div></div>"],Ir=["<media-player",' keep-alive id="player" class="','"'," key-disabled","",' autoplay src="https://files.vidstack.io/sprite-fight/720p.mp4" crossorigin playsinline><media-provider class="max-h-screen max-w-screen [&amp;>video]:max-h-screen [&amp;>video]:max-w-screen [&amp;>video]:h-full [&amp;>video]:w-full"><media-poster aria-hidden="true" class="absolute inset-0 block h-full w-full rounded-md opacity-0 transition-opacity data-[visible]:opacity-100 [&amp;>img]:h-full [&amp;>img]:w-full [&amp;>img]:object-cover"></media-poster><!--$-->',"<!--/--></media-provider><!--$-->","<!--/--><!--$-->","<!--/--><!--$-->","<!--/--><!--$-->","<!--/--></media-player>"],Rr=["<track",">"];function Or(e){const r=je();let t;we();const[o,s]=te(),[i,l]=y(void 0);C(()=>{r.query.v&&l(r.query.v)});const[d]=Et(),u=Dt();y(void 0);const[p,$]=y([]),[S,w]=Me({}),[f,m]=y(0);r.query.t;const[g,x]=y(!1),[k,E]=y();C(()=>{console.log(I(),D()),d()?Array.isArray(d().videos)?E(d().videos):E(d().relatedStreams):(E(u.list()),console.log(u,"queue 2 list"))}),C(()=>{});const[I,L]=y(null),[D,j]=y(null);C(()=>{});const[c,R]=xe(),A=()=>{if(console.log("playing next",I()),!I())return;const h=new URL(window.location.origin+I().url);c.fullscreen&&h.searchParams.set("fullscreen",c.fullscreen),He(h.pathname+h.search.toString()),L(null)},[M,oe]=y(!1),se=5,[ze,co]=y(se);let Be;function Q(){console.log("dismiss"),clearInterval(Be),oe(!1)}T(()=>{Q()});const[U,uo]=y([]),[ae,Ve]=y({show:!1,dismissed:!1});C(()=>{});const V=()=>{};ve(()=>{document.addEventListener("visibilitychange",V),document.addEventListener("pagehide",V),document.addEventListener("keydown",$e),window.addEventListener("beforeunload",V),window.addEventListener("unload",V),document.addEventListener("media-enter-fullscreen-request",h=>{h.preventDefault(),h.stopPropagation(),console.log("Full screen request intercepted. Element will not go full screen.")},{capture:!0}),T(()=>{document.removeEventListener("keydown",$e),document.removeEventListener("visibilitychange",V),document.removeEventListener("pagehide",V),document.removeEventListener("media-enter-fullscreen-request",h=>{h.preventDefault(),h.stopPropagation()})})}),C(()=>{g()});const We=mn(),He=ye();C(()=>{We()});const $e=h=>{if(document.activeElement?.tagName!=="INPUT")switch(h.key){case"f":console.log(`f key pressed, fullscreen: ${document.fullscreenElement}`),document.fullscreenElement?(document.exitFullscreen(),screen.orientation.unlock(),R({fullscreen:void 0},{replace:!0})):(document.documentElement.requestFullscreen(),screen.orientation.lock("landscape").catch(()=>{}),R({fullscreen:!0},{replace:!0}),document.body.scroll({top:0,left:0,behavior:"smooth"})),h.preventDefault();break;case"m":t.muted=!t.muted,h.preventDefault();break;case"j":t.currentTime=Math.max(t.currentTime-10,0),h.preventDefault();break;case"c":const q=t.textTracks.toArray().find(N=>N.id.startsWith("track-")&&(N.language==="en"||N.language==="en_US"||N.language==="en_GB"));if(q){console.log(q.id);const N=p().find(X=>X.id===q.id)?.metadata.url;console.log(N,"track url"),N&&qn(N,null).then(({srtUrl:X})=>{console.log(q.src,X,"track src"),w(q.id,{src:X}),console.log(S,"captions store track"),q.mode=q.mode==="showing"?"hidden":"showing"})}h.preventDefault();break;case"k":t.paused||t.pause(),h.preventDefault();break;case" ":if(h.preventDefault(),console.log(document.activeElement?.tagName),document.activeElement?.tagName==="BUTTON"){document.activeElement.click();return}if(document.activeElement?.tagName.startsWith("MEDIA-"))return;t.paused||t.pause();break;case"ArrowUp":h.shiftKey&&(t.volume=Math.min(t.volume+.05,1),h.preventDefault());break;case"ArrowDown":h.shiftKey&&(t.volume=Math.max(t.volume-.05,0),h.preventDefault());break;case"ArrowLeft":if(h.altKey)return;h.shiftKey?Ge():t.currentTime=Math.max(t.currentTime-5,0),h.preventDefault();break;case"ArrowRight":if(h.altKey)return;h.shiftKey?Je():t.currentTime=t.currentTime+5,h.preventDefault();break;case"0":t.currentTime=0,h.preventDefault();break;case"N":h.shiftKey&&(A(),h.preventDefault());break;case"Escape":M()&&I()?(Q(),h.preventDefault()):ae().show&&(Ve({show:!1,dismissed:!0}),h.preventDefault());break;case",":t.currentTime-=.04;break;case".":t.currentTime+=.04;break;case"R":h.shiftKey&&(e.onReload?.(),h.preventDefault());break}};y([]),C(()=>{});const Ge=()=>{},Je=()=>{},[Y,ie]=J();return C(()=>{r.pathname!=="/watch"?ie("player","small",!0):(ie("player","small",!1),Y.player.dismissed&&ie("player","dismissed",!1))}),v(Ir,b(),` z-[99999] aspect-video bg-black text-white font-sans overflow-hidden ring-primary data-[focus]:ring-4 ${c.fullscreen&&!Y.player.small?"!absolute inset-0 w-screen h-screen":""} ${c.fullscreen?"":"!sticky sm:!relative !top-0"} ${Y.player.small?"!sticky sm:!sticky !top-10 !left-1 !w-56 sm:!w-72 lg:!w-96 ":""} ${Y.player.dismissed?"!hidden":""}`,P("current-time",a(f(),!0),!1),P("tabindex",-1,!1)+P("playbackrate",a(o.speed,!0),!1),P("muted",o.muted,!0)+P("volume",a(o.volume,!0),!1),a(n(B,{get each(){return Object.values(S)},children:h=>v(Rr,b()+P("id",a(h.id,!0),!1)+P("kind",a(h.kind,!0),!1)+P("src",a(S[h.id].src,!0),!1)+P("srclang",a(h.srcLang,!0),!1)+P("label",a(h.label,!0),!1)+P("data-type",a(h.dataType,!0),!1))})),a(n(O,{get when(){return U().length>0&&ae().show&&!ae().dismissed},get children(){return v(Pr,b(),a(U()[U().length-1]?.name),a(U()[U().length-1]?.details),a(U()[U().length-1]?.message))}})),a(n(O,{get when(){return M()&&I()},get children(){return v(Cr,b(),a(ze()),a(n(Lt,{layout:"sm:grid",get v(){return I()?.info??void 0}})),a(n(W,{onClick:()=>{Q(),A()},label:"Play now (Shift + N)"})),a(n(W,{appearance:"subtle",class:"bg-bg1",onClick:()=>{Q()},label:"Dismiss (Esc)"})))}})),a(n($r,{})),a(n(kr,{})))}const Er=ee({}),Dr=e=>{const[r,t]=Me({}),[o,s]=y();C(()=>{o()||s(document.querySelector("media-player"))});let i;return C(()=>{o()&&(i=o().subscribe(({paused:l})=>{console.log("playerStateStore.tsx:39",l),t({paused:l})}))}),T(()=>{i?.()}),n(Er.Provider,{value:r,get children(){return e.children}})};var Lr=["<nav",' class="flex gap-2 px-2 py-2 justify-evenly">',"</nav>"],Tr=["<div",' class="w-6 h-6">',"</div>"],Ar=["<span",' class="mt-1 text-xs font-semibold ">',"</span>"];function Mr(e){return v(Lr,b(),a(n(B,{get each(){return e.items},children:r=>n(de,{activeClass:"text-primary",inactiveClass:"text-text2",get href(){return r.href},class:"flex flex-col items-center justify-center text-sm ",get children(){return[v(Tr,b(),a(r.icon)),v(Ar,b(),a(r.label))]}})})))}function _r(e){return ne({a:{baseProfile:"tiny",version:"1.2",viewBox:"0 0 24 24"},c:'<path d="M12 3s-6.186 5.34-9.643 8.232A1.041 1.041 0 0 0 2 12a1 1 0 0 0 1 1h2v7a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-4h4v4a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-7h2a1 1 0 0 0 1-1 .98.98 0 0 0-.383-.768C18.184 8.34 12 3 12 3z"/>'},e)}function Fr(e){return ne({a:{baseProfile:"tiny",version:"1.2",viewBox:"0 0 24 24"},c:'<path d="M17.414 6.586a2 2 0 0 0-2.828 0L12 9.172 9.414 6.586a2 2 0 1 0-2.828 2.828L9.171 12l-2.585 2.586a2 2 0 1 0 2.828 2.828L12 14.828l2.586 2.586c.39.391.902.586 1.414.586s1.024-.195 1.414-.586a2 2 0 0 0 0-2.828L14.829 12l2.585-2.586a2 2 0 0 0 0-2.828z"/>'},e)}function jr(e){return ne({a:{viewBox:"0 0 1024 1024"},c:'<path d="M834.1 469.2A347.49 347.49 0 0 0 751.2 354l-29.1-26.7a8.09 8.09 0 0 0-13 3.3l-13 37.3c-8.1 23.4-23 47.3-44.1 70.8-1.4 1.5-3 1.9-4.1 2-1.1.1-2.8-.1-4.3-1.5-1.4-1.2-2.1-3-2-4.8 3.7-60.2-14.3-128.1-53.7-202C555.3 171 510 123.1 453.4 89.7l-41.3-24.3c-5.4-3.2-12.3 1-12 7.3l2.2 48c1.5 32.8-2.3 61.8-11.3 85.9-11 29.5-26.8 56.9-47 81.5a295.64 295.64 0 0 1-47.5 46.1 352.6 352.6 0 0 0-100.3 121.5A347.75 347.75 0 0 0 160 610c0 47.2 9.3 92.9 27.7 136a349.4 349.4 0 0 0 75.5 110.9c32.4 32 70 57.2 111.9 74.7C418.5 949.8 464.5 959 512 959s93.5-9.2 136.9-27.3A348.6 348.6 0 0 0 760.8 857c32.4-32 57.8-69.4 75.5-110.9a344.2 344.2 0 0 0 27.7-136c0-48.8-10-96.2-29.9-140.9zM713 808.5c-53.7 53.2-125 82.4-201 82.4s-147.3-29.2-201-82.4c-53.5-53.1-83-123.5-83-198.4 0-43.5 9.8-85.2 29.1-124 18.8-37.9 46.8-71.8 80.8-97.9a349.6 349.6 0 0 0 58.6-56.8c25-30.5 44.6-64.5 58.2-101a240 240 0 0 0 12.1-46.5c24.1 22.2 44.3 49 61.2 80.4 33.4 62.6 48.8 118.3 45.8 165.7a74.01 74.01 0 0 0 24.4 59.8 73.36 73.36 0 0 0 53.4 18.8c19.7-1 37.8-9.7 51-24.4 13.3-14.9 24.8-30.1 34.4-45.6 14 17.9 25.7 37.4 35 58.4 15.9 35.8 24 73.9 24 113.1 0 74.9-29.5 145.4-83 198.4z"/>'},e)}function Nr(e){return ne({a:{viewBox:"0 0 1024 1024"},c:'<path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"/>'},e)}function Kr(e={}){return Object.keys(e).reduce((r,t)=>t==="days"||e[t]===!1?r:e[t]===!0?`${r}; ${t}`:`${r}; ${t}=${e[t]}`,"")}const Ur=(e,r,t)=>{if(z)return;const o={days:7,path:"/",...t},s=new Date(Date.now()+o.days*864e5).toUTCString();document.cookie=e+"="+encodeURIComponent(r)+"; expires="+s+Kr(o)},qr=(e,r="")=>!z&&document.cookie.split("; ").reduce((t,o)=>{const s=o.split("=");return s[0]===e?decodeURIComponent(s[1]):t},"")||r;function zr(e,r){const[t,o]=y(()=>qr(e,r));return[t,(i,l={})=>{o(i),Ur(e,i,l)}]}const Oe=e=>n(Tt,{get open(){return e.isOpen},get onOpenChange(){return e.onOpenChange},get children(){return[n(At,{class:"p-1 outline-none focus-visible:ring-2 focus-visible:ring-primary rounded-md",get children(){return n(En,{get children(){return e.triggerIcon}})}}),n(Mt,{get children(){return n(_t,{class:`bg-bg1 border border-bg3/80 rounded-md z-[999999]
          -top-2
          animate-in
          fade-in
          slide-in-from-top-10
          duration-200
          `,get children(){return[n(Ae,{}),n(Tn,{class:`max-h-[40vh] overflow-y-auto
            p-2
            `,get value(){return e.selectedValue},get onChange(){return e.onChange},get children(){return n(B,{get each(){return e.options},children:r=>n(An,{get value(){return r.value??r.label},class:"cursor-pointer w-full border-bg3 flex relative items-center px-7 py-2 rounded border-b last:border-none hover:bg-bg3 focus-visible:bg-bg3 focus-visible:ring-4 focus-visible:ring-primary focus-visible:outline-none",get onClick(){return r.onClick},get children(){return[n(Dn,{class:"inline-flex absolute left-0",get children(){return n(fn,{fill:"currentColor",class:"h-4 w-4 mx-1 text-text1"})}}),r.label]}})})}})]}})}})]}});var Br=["<button",' class="sm:hidden bg-bg2 p-1 px-2 text-gray-500 flex items-center justify-center hover:bg-bg1 hover:text-text1 focus-visible:ring-2 focus-visible:ring-primary/80 rounded focus-visible:outline-none " aria-label="Back">',"</button>"],Vr=["<ul",' class="','" aria-multiselectable="false" aria-live="polite" aria-label="Suggestions" id="search-suggestion-list">',"</ul>"],Wr=["<div",' class="','"><!--$-->','<!--/--><label for="search-input" class="sr-only">Search</label><input aria-haspopup="listbox" aria-owns="suggestion-list"',' aria-controls="suggestion-list" id="search-input" class="w-full border-0 max-w-full peer outline-none bg-bg1 border-bg2 focus:border-2 focus:border-r-0 placeholder-shown:focus:border-r-2 text-text1 text-sm rounded-lg rounded-r-none placeholder-shown:rounded-r-lg transition-transform focus:ring-primary focus:border-primary py-1 px-2.5" type="combobox"',' placeholder="Search... (Ctrl + K)" aria-autocomplete="list"','><div class="relative peer-placeholder-shown:hidden flex w-max items-center justify-center gap-1 peer h-[29px] peer-focus:h-[33px] bg-bg1 py-1 px-1 -left-1 border-0 peer-focus:border-2 peer-focus:border-primary peer-focus:border-l-0 rounded-r-lg"><button id="search-button" class="text-gray-500 flex items-center justify-center hover:bg-bg1 hover:text-text1 focus-visible:ring-2 focus-visible:ring-primary/80 rounded focus-visible:outline-none " aria-label="Search">','</button><button id="search-clear-button" class="right-2 top-1/2 transform text-gray-500 flex items-center justify-center hover:bg-bg1 hover:text-text1 focus-visible:ring-2 focus-visible:ring-primary/80 rounded focus-visible:outline-none " aria-label="Clear search">',"</button></div><!--$-->","<!--/--></div>"],Hr=["<button",' id="','" role="none" class="text-xs text-gray-500 h-8 w-8 flex items-center justify-center hover:bg-bg1 hover:text-text1 focus-visible:ring-2 focus-visible:ring-primary/80 rounded focus-visible:outline-none " aria-label="','">',"</button>"],Gr=["<li",' class="','" id="','"',' tabindex="0"','><span aria-hidden="true">','</span><div class="ml-2 flex items-center"><button id="','" role="none" class="text-xs text-gray-500 h-8 w-8 flex items-center justify-center hover:bg-bg1 hover:text-text1 focus-visible:ring-2 focus-visible:ring-primary/80 rounded focus-visible:outline-none " aria-label="','">',"</button><!--$-->","<!--/--></div></li>"];const Jr=()=>{const[e,r]=y(""),[t,o]=y([]),[s,i]=y(-1),[l]=xe();C(()=>{p(l.search_query||De(()=>u()))});const[d]=te();_e(()=>({queryKey:["suggestions"],queryFn:async()=>(console.log("fetching suggestions",e()),await fetch(d.instance?.api_url+"/suggestions?query="+e()).then(f=>f.json())),enabled:!!(e().length>1&&d.instance?.api_url&&$()),select:f=>{console.log(f),f&&!f.error?o(f.map(m=>({value:m,isHistory:!1}))):o([])}})),ye(),J();const[u,p]=y(""),[$,S]=y(!1);ve(()=>{document.addEventListener("keydown",w),T(()=>{document.removeEventListener("keydown",w)})});function w(f){f.ctrlKey&&f.key==="k"&&f.preventDefault(),f.key}return v(Wr,b(),`relative z-[999999] flex items-center transition-all duration-500  ${t().length>0&&$()?"-left-10 sm:left-0 w-screen sm:w-auto":""}`,a(n(O,{get when(){return t().length>0&&$()},get children(){return v(Br,b(),a(n(Qt,{"aria-hidden":"true",class:"w-6 h-6"})))}})),P("aria-expanded",t().length>0&&a($(),!0),!1),P("value",a(u(),!0),!1),P("aria-activedescendant",s()>-1?`option-${a(s(),!0)}`:a(void 0,!0),!1),a(n(Yt,{class:"w-5 h-5","aria-hidden":"true"})),a(n(Pe,{class:"w-5 h-5","aria-hidden":"true"})),a(n(O,{get when(){return t().length>0&&$()},get children(){return n(Z,{get children(){return v(Vr,b(),"fixed w-screen h-screen sm:h-auto left-0 right-0 sm:w-max sm:min-w-[30rem] sm:left-[calc(70vw-18rem)] top-10 sm:mt-1 bg-bg1 border-1 border-bg2/80 p-2 z-[999999] text-text1 rounded-md border border-bg1 shadow-md transform transition-transform duration-250 ease-in origin-center animate-in fade-in aria-[expanded]:animate-out aria-[expanded]:fade-out ",a(n(B,{get each(){return t()},children:(f,m)=>v(Gr,b(),`text-sm leading-none text-text1 border-b border-bg2 last:border-none rounded-md flex items-center justify-between h-8 px-2 py-5 relative select-none outline-none cursor-pointer hover:bg-bg2 ${s()===m()?"bg-bg2 focus-visible:ring-2 ring-primary":""}`,`search-option-${a(m(),!0)}`,P("aria-selected",a(s(),!0)===a(m(),!0),!1),P("aria-label",a(f.value,!0),!1),a(f.value),`search-suggestion-use-${a(m(),!0)}`,`Use suggestion ${a(f.value,!0)} (Enter)`,a(n(Fe,{class:"w-5 h-5","aria-hidden":"true"})),a(n(O,{get when(){return f.isHistory},get children(){return v(Hr,b(),`search-suggestion-remove-${a(m(),!0)}`,`Remove suggestion ${a(f.value,!0)} (Ctrl+Delete)`,a(n(Pe,{class:"w-5 h-5","aria-hidden":"true"})))}})))})))}})}})))},Qr=Jr;var Yr=["<img",' src="/logo.svg" alt="Conduit" class="h-8 w-8 aspect-square min-w-max ">'],Xr=["<div",' class="flex items-start flex-col gap-2 text-text1"><details class="text-xs"><summary class="link">Users: <!--$-->',"<!--/--></summary><!--$-->","<!--/--></details><div>Syncing: <!--$-->","<!--/--></div><div>IndexedDB: <!--$-->","<!--/--></div><div>WebRTC: <!--$-->","<!--/--></div><div>OPFS: <!--$-->","<!--/--></div></div>"],Zr=["<div",' class="w-full h-full bg-bg1"><div class="p-4 flex flex-col items-center justify-center gap-2"><!--$-->',"<!--/--><!--$-->","<!--/--><!--$-->","<!--/--><!--$-->","<!--/--></div></div>"],eo=["<nav",' class="fixed top-0 left-0 bg-bg2 w-full z-[99999] h-10 px-2 flex items-center justify-between"><button class="sr-only focus:not-sr-only absolute top-0 left-0">Skip navigation</button><div class="flex items-center justify-between w-full max-w-full min-w-0"><!--$-->','<!--/--><ul class="hidden md:inline">',"</ul><!--$-->",'<!--/--><div class="flex items-center gap-2 "><!--$-->',"<!--/--><!--$-->","<!--/--><!--$-->","<!--/--></div></div><!--$-->","<!--/--></nav>"],to=["<div",' class="flex items-center gap-2">ID: <!--$-->',"<!--/-->Name: <!--$-->","<!--/--> <!--$-->","<!--/--></div>"];function no(){const[e,r]=he(qe),[,t]=zr("theme","monokai");we();const o=[{href:"/feed",label:"Feed"},{href:"/trending",label:"Trending"},{href:"/library",label:"Library"},{href:"/import",label:"Import"}],s=_e(()=>({queryKey:["instances"],queryFn:async()=>{const c=await fetch("https://piped-instances.kavin.rocks/");if(!c.ok)throw new Error("Failed to fetch instances");return await c.json()},initialData:Ft("instances",[],"json","localStorage"),select:c=>(jt("instances",c,"localStorage"),c),retry:c=>c<3})),[i,l]=te(),d=["Alice","Bob","Charlie","Dave","Eve","Frank","Grace","Heidi","Ivan","Judy","Kevin","Larry","Mallory","Nancy","Oscar","Peggy","Quentin","Rupert","Sybil","Trent","Ursula","Victor","Walter","Xavier","Yvonne","Zelda"],[u]=J(),[p,$]=y(!1),[S,w]=y(d[Math.floor(Math.random()*d.length)]),[f,m]=y(""),[g,x]=y("");C(()=>{const c=JSON.parse(localStorage.getItem("room")||"{}");c.name&&w(c.name),m(c.id||""),x(c.password||"")});const[k,E]=y(!1),[I,L]=y(!1);function D(c,R){return c==="connected"&&R==="connected"?"online":c==="connected"&&R!=="connected"?"offline":c!=="connected"&&R==="connected"?"volatile":"disconnected"}const j=()=>{if(!s.data)return;const c=s.data;let R=c.findIndex(M=>M.api_url===i.instance.api_url);R=R>-1?R:0;const A=(R+1)%c.length;l("instance",c[A]),Kt.show(`You are now connected to ${c[A].name}`)};return ve(()=>{z||document.addEventListener("keydown",c=>{c.key==="I"&&c.shiftKey&&!c.ctrlKey&&!c.altKey&&(j(),c.preventDefault())})}),T(()=>{z||document.removeEventListener("keydown",c=>{c.key==="I"&&c.shiftKey&&!c.ctrlKey&&!c.altKey&&(j(),c.preventDefault())})}),v(eo,b(),a(n(de,{href:"/",class:"text-text1 mx-2 w-8 h-8",get children(){return v(Yr,b())}})),a(n(B,{each:o,children:c=>n(de,{get href(){return c.href},class:"text-sm p-1 text-left transition ",get children(){return c.label}})})),a(n(Qr,{})),a(n(jn,{get children(){return[n(Nn,{class:"p-1 outline-none focus-visible:ring-2 focus-visible:ring-primary rounded-md",get children(){return n(nt,{get children(){return[n(H,{get when(){return u.sync.syncing},get children(){return n(pn,{class:"w-6 h-6 text-yellow-500"})}}),n(H,{get when(){return D(u.sync.providers.opfs,u.sync.providers.webrtc)==="online"},get children(){return n(Xt,{class:"w-7 h-7 text-green-500"})}}),n(H,{get when(){return D(u.sync.providers.opfs,u.sync.providers.webrtc)==="disconnected"},get children(){return n(Fr,{class:"w-9 h-9 text-red-500"})}}),n(H,{get when(){return D(u.sync.providers.opfs,u.sync.providers.webrtc)==="offline"},get children(){return n(Zt,{class:"w-7 h-7 text-text1"})}}),n(H,{get when(){return D(u.sync.providers.opfs,u.sync.providers.webrtc)==="volatile"},get children(){return n(en,{class:"w-6 h-6 text-text1"})}})]}})}}),n(Fn,{get children(){return n(Mn,{class:`bg-bg1 border border-bg3/80 p-2 rounded-md
                animate-in
                fade-in
                slide-in-from-top-10
                duration-200
                z-[99999]
                `,get children(){return[n(Ae,{}),n(_n,{get class(){return`text-sm p-1 text-left flex flex-col gap-2 items-center ${f()?"text-green-600":"text-red-600"}`},get children(){return[n(O,{get when(){return f()},get children(){return["Connected: ",f(),v(Xr,b(),a(u.sync.users.length),a(n(B,{get each(){return u.sync.users},children:c=>v(to,b(),a(c.id),a(c.name),c.name===S()&&"(You)")})),u.sync.syncing?"true":"false",a(u.sync.providers.idb),a(u.sync.providers.webrtc),a(u.sync.providers.opfs)),n(W,{label:"Leave",onClick:()=>{localStorage.removeItem("room"),location.reload()}})]}}),n(O,{get when(){return!f()},get children(){return["Disconnected",n(W,{label:"Join room",onClick:()=>$(!0)})]}})]}})]}})}})]}})),a(n(Oe,{get isOpen(){return k()},onOpenChange:E,onChange:c=>{r(c),t(c)},options:[{value:"monokai",label:"Monokai"},{value:"dracula",label:"Dracula"},{value:"discord",label:"Discord"},{value:"github",label:"Github"}],get selectedValue(){return e()},get triggerIcon(){return n(hn,{fill:"currentColor",class:"h-5 w-5 text-text1"})}})),a(n(Oe,{get isOpen(){return I()},onOpenChange:L,get selectedValue(){return i.instance.api_url},onChange:c=>{let R=s.data.find(A=>A.api_url===c);R&&l("instance",R)},get options(){return s.data.map(c=>({label:`${c.name} - ${c.uptime_24h.toFixed(0)}%`,value:c.api_url}))},get triggerIcon(){return n(gn,{fill:"currentColor",class:"h-5 w-5 text-text1"})}})),a(n(Nt,{get isOpen(){return p()},title:"Join Room",setIsOpen:$,get children(){return v(Zr,b(),a(n(ce,{name:"name",get value(){return S()},onInput:c=>w(c),placeholder:"Name",type:"text",class:"w-full"})),a(n(ce,{name:"room",type:"text",placeholder:"Room ID",get value(){return f()},onInput:c=>m(c)})),a(n(ce,{name:"password",type:"password",placeholder:"Password",get value(){return g()},onInput:c=>x(c)})),a(n(W,{onClick:()=>{localStorage.setItem("room",JSON.stringify({name:S(),id:f(),password:g()})),location.reload()},label:"Join"})))}})))}var ro=["<div",' class="fixed h-1 w-full -mx-2 top-0 z-[9999999]"><div class="','"></div></div>'],oo=["<div",' class="','"><!--$-->','<!--/--><div aria-hidden="true" class="h-10"></div><!--$-->',"<!--/--><!--$-->","<!--/--><!--$-->","<!--/--><main><!--$-->","<!--/--><!--$-->",'<!--/--></main><div class="fixed bottom-0 left-0 w-full md:hidden pb-2 sm:pb-5 bg-bg2 z-50">','</div><div class="h-20 md:h-0"></div><!--$-->',"<!--/--></div>"],so=["<div",">Loading...</div>"],ao=["<div",' role="alert" aria-live="assertive" aria-atomic="true" class="sr-only">Current page: <!--$-->',"<!--/--> </div>"];const io=()=>import("./ReloadPrompt.mjs"),[me,fe]=y(""),qe=ee([me,fe]);function Ao(){const e=pe();rt(()=>{function s(d){return d.split(";").map(u=>u.split("=")).reduce((u,p)=>(u[decodeURIComponent(p[0].trim())]=decodeURIComponent(p[1].trim()),u),{})}const l=s(Gt?e?.request.headers.get("cookie")??"":document.cookie).theme??"monokai";fe(l)});const[r]=J(),t=new Wt({defaultOptions:{queries:{refetchOnMount:!0,refetchOnReconnect:!0,refetchOnWindowFocus:!1,retry:s=>s<3,suspense:!0}}}),o=we();return C(()=>{console.log(o.store,"sync store")}),n(On,{root:s=>n(Se,{get children(){return n(Jt,{tags:[],get children(){return n(Ht,{client:t,get children(){return n(qe.Provider,{value:[me,fe],get children(){return n(Ut,{get children(){return n(Vt,{get children(){return n(qt,{get children(){return n(zt,{get children(){return n(Dr,{get children(){return n(Bt,{get children(){return v(oo,b(),`${a(me(),!0)} bg-bg1 font-manrope text-sm scrollbar text-text1 selection:bg-accent2 selection:text-text3 overflow-x-hidden`,a(n(no,{})),a(n(Or,{})),a(n(O,{get when(){return r.loading},get children(){return v(ro,b(),"h-1 bg-gradient-to-r from-accent1 via-primary to-accent1 bg-repeat-x w-full animate-stripe")}})),a(n(Z,{get children(){return n(Un,{get children(){return n(Kn,{class:"fixed bottom-0 right-0 p-4 flex flex-col gap-2 z-[999999] w-[400px] max-w-[100vw] outline-none"})}})}})),a(s.children),a(n(ot,{get children(){return n(Se,{get fallback(){return v(so,b())},get children(){return n(io,{})}})}})),a(n(Mr,{get items(){return[{href:"/feed",label:"Feed",icon:n(_r,{fill:"currentColor",class:"w-6 h-6 "})},{href:"/trending",label:"Trending",icon:n(jr,{fill:"currentColor",class:"w-6 h-6 "})},{href:"/library",label:"Library",icon:n(Nr,{fill:"currentColor",class:"w-6 h-6 "})}]}})),a(n(lo,{})))}})}})}})}})}})}})}})}})}})}}),get children(){return n(Xe,{})}})}const lo=()=>{const e=je();return n(Z,{get children(){return v(ao,b(),a(e.pathname))}})};export{qe as ThemeContext,Ao as default};
//# sourceMappingURL=app.mjs.map
